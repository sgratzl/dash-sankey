{"version":3,"sources":["webpack://dash_sankey/webpack/bootstrap","webpack://dash_sankey/external \"React\"","webpack://dash_sankey/external \"PropTypes\"","webpack://dash_sankey/./src/lib/components/DashSankey.css?3279","webpack://dash_sankey/./src/lib/components/DashSankey.css","webpack://dash_sankey/./node_modules/css-loader/dist/runtime/api.js","webpack://dash_sankey/./node_modules/style-loader/lib/addStyles.js","webpack://dash_sankey/./node_modules/style-loader/lib/urls.js","webpack://dash_sankey/./node_modules/use-resize-observer/dist/bundle.esm.js","webpack://dash_sankey/./node_modules/d3-array/src/sum.js","webpack://dash_sankey/./node_modules/d3-array/src/max.js","webpack://dash_sankey/./node_modules/d3-array/src/min.js","webpack://dash_sankey/./node_modules/d3-sankey/src/align.js","webpack://dash_sankey/./node_modules/d3-sankey/src/constant.js","webpack://dash_sankey/./node_modules/d3-sankey/src/sankey.js","webpack://dash_sankey/./node_modules/d3-sankey/node_modules/d3-path/src/path.js","webpack://dash_sankey/./node_modules/d3-sankey/node_modules/d3-shape/src/array.js","webpack://dash_sankey/./src/lib/utils.ts","webpack://dash_sankey/./src/lib/internal/sankey/model.ts","webpack://dash_sankey/./src/lib/internal/sankey/hooks.ts","webpack://dash_sankey/./node_modules/d3-path/src/path.js","webpack://dash_sankey/./node_modules/d3-shape/src/array.js","webpack://dash_sankey/./node_modules/d3-shape/src/constant.js","webpack://dash_sankey/./node_modules/d3-shape/src/curve/linear.js","webpack://dash_sankey/./node_modules/d3-shape/src/point.js","webpack://dash_sankey/./node_modules/d3-shape/src/line.js","webpack://dash_sankey/./node_modules/d3-shape/src/area.js","webpack://dash_sankey/./node_modules/d3-shape/src/curve/monotone.js","webpack://dash_sankey/./src/lib/internal/sankey/renderUtils.ts","webpack://dash_sankey/./src/lib/internal/sankey/SankeyLayer.tsx","webpack://dash_sankey/./src/lib/internal/sankey/SankeyLink.tsx","webpack://dash_sankey/./src/lib/internal/sankey/SankeyMissingInLink.tsx","webpack://dash_sankey/./src/lib/internal/sankey/SankeyMissingOutLink.tsx","webpack://dash_sankey/./src/lib/internal/sankey/SankeyNode.tsx","webpack://dash_sankey/./src/lib/internal/sankey/DashSankeyImpl.tsx","webpack://dash_sankey/./src/lib/internal/sankey/propTypes.ts","webpack://dash_sankey/./src/lib/components/DashSankey.tsx","webpack://dash_sankey/./src/lib/components/FacettedSankey.tsx","webpack://dash_sankey/./src/lib/index.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","window","content","options","transform","undefined","locals","___CSS_LOADER_API_IMPORT___","push","useSourceMap","list","toString","this","map","item","cssMapping","btoa","sourceMapping","sourceMap","base64","unescape","encodeURIComponent","JSON","stringify","data","concat","sourceURLs","sources","source","sourceRoot","join","cssWithMappingToString","mediaQuery","dedupe","alreadyImportedModules","length","id","_i","fn","memo","stylesInDom","isOldIE","document","all","atob","apply","arguments","getTarget","target","parent","querySelector","getElement","styleTarget","HTMLIFrameElement","contentDocument","head","e","singleton","singletonCounter","stylesInsertedAtTop","fixUrls","addStylesToDom","styles","domStyle","refs","j","parts","addStyle","listToStyles","newStyles","base","part","css","media","insertStyleElement","style","insertInto","Error","lastStyleElementInsertedAtTop","insertAt","nextSibling","insertBefore","appendChild","firstChild","before","removeStyleElement","parentNode","removeChild","idx","indexOf","splice","createStyleElement","createElement","attrs","type","nonce","getNonce","addAttrs","el","keys","forEach","setAttribute","obj","update","remove","result","default","styleIndex","applyToSingletonTag","URL","createObjectURL","revokeObjectURL","Blob","link","rel","createLinkElement","updateLink","href","applyToTag","newObj","DEBUG","newList","mayRemove","textStore","replaceText","index","replacement","filter","Boolean","styleSheet","cssText","cssNode","createTextNode","childNodes","autoFixUrls","convertToAbsoluteUrls","blob","oldSrc","location","baseUrl","protocol","host","currentDir","pathname","replace","fullMatch","origUrl","newUrl","unquotedOrigUrl","trim","$1","test","opts","onResize","onResizeRef","current","resizeObserverRef","_useState","width","height","size","setSize","didUnmount","previous","refCallback","subscriber","refOrElement","_ref","ref","refElement","callbackRefElement","element","callSubscriber","lastReportedElementRef","cleanupRef","HTMLElement","useResolvedElement","ResizeObserver","entries","Array","isArray","entry","newWidth","Math","round","contentRect","newHeight","newSize","observe","unobserve","sum","values","valueof","max","min","targetDepth","depth","node","justify","sourceLinks","center","targetLinks","constant","x","ascendingSourceBreadth","a","b","ascendingBreadth","ascendingTargetBreadth","y0","defaultId","defaultNodes","graph","nodes","defaultLinks","links","find","nodeById","computeLinkBreadths","y1","Sankey","py","sort","linkSort","x0","x1","dx","dy","align","iterations","sankey","computeNodeLinks","computeNodeValues","computeNodeDepths","computeNodeHeights","computeNodeBreadths","Map","fixedValue","Set","next","add","columns","kx","floor","layer","column","computeNodeLayers","ky","y","reorderLinks","initializeNodeBreadths","alpha","pow","beta","relaxRightToLeft","relaxLeftToRight","w","v","targetTop","reorderNodeLinks","resolveCollisions","sourceTop","subject","resolveCollisionsBottomToTop","resolveCollisionsTopToBottom","nodeId","_","nodeAlign","nodeSort","nodeWidth","nodePadding","extent","pi","PI","tau","tauEpsilon","Path","_x0","_y0","_x1","_y1","path","constructor","moveTo","closePath","lineTo","quadraticCurveTo","bezierCurveTo","x2","y2","arcTo","x21","y21","x01","y01","l01_2","abs","x20","y20","l21_2","l20_2","l21","sqrt","l01","tan","acos","t01","t21","arc","a0","a1","ccw","cos","sin","cw","da","rect","h","slice","classNames","cs","OverlapHelper","ids","set","givenIds","has","isEmpty","copy","vi","clear","elems","elem","withoutUpdate","deriveBox","defaultValue","left","right","top","bottom","PADDING_PROP_TYPES","oneOfType","number","isRequired","shape","noop","DEFAULT_PADDING","extractLayers","layers","internalLayers","xPositions","xPositionToLayer","overlap","addUpdate","alignLayer","useSankeyLayout","padding","sankeyGen","alignmentsToFunction","lookup","asNode","missingIn","missingOut","asLink","linkId","transformedLevels","intersect","lookupNode","getOverlap","extractGraph","layoutGraph","g","maxLayerY1","reduce","acc","matchLayerHelper","graphLayers","selectedIndices","includes","useSelections","selection","selections","setProps","selectionsOverlaps","matchLayer","selectionOverlap","onClick","preventDefault","stopPropagation","currentTarget","dataset","hoveredSelection","setHoveredSelection","onMouseEnter","onMouseLeave","isSelected","sId","others","from","Linear","context","_context","areaStart","_line","areaEnd","NaN","lineStart","_point","lineEnd","point","defined","curve","output","area","k","buffer","array","defined0","x0z","y0z","arealine","line","lineX0","lineY0","lineY1","lineX1","sign","slope3","that","h0","h1","s0","s1","slope2","t0","t1","MonotoneX","MonotoneY","ReflectContext","monotoneX","missingInOffset","pathGen","lineOffset","fraction","shift","targetOffset","missingOutPath","off","curve1","curve2","missingInPath","toValue","total","toLocaleString","percentage","_t0","nLayers","layerHeight","className","allIds","selectionShift","prevOverlap","shiftSelections","without","color","fill","isNotEmpty","isLastLayer","nodeHeight","toPercentageSuffix","props","showLayers","ID_ARRAY","arrayOf","string","NODE_ARR","LINK_ARR","SELECTION_PROP_TYPE","oneOf","children","resetSelection","computedWidth","fixedWidth","defaultProps","propTypes","func","bool","facets","facetHeight","facetObjects","f","changed","facet"],"mappings":"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","file":"dash_sankey.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 9);\n","(function() { module.exports = window[\"React\"]; }());","(function() { module.exports = window[\"PropTypes\"]; }());","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./DashSankey.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"insertAt\":\"top\",\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./DashSankey.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./DashSankey.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".dash-sankey-node,\\n.dash-sankey-link {\\n  fill: steelblue;\\n  cursor: pointer;\\n}\\n\\n.dash-sankey-link {\\n  opacity: 0.2;\\n  stroke: none;\\n}\\n\\n.dash-sankey-link.dash-sankey-selection {\\n  opacity: 0.5;\\n}\\n\\n.dash-sankey-node-name {\\n  dominant-baseline: central;\\n}\\n\\n.dash-sankey-node-name__last {\\n  text-anchor: end;\\n}\\n\\n.dash-sankey-node:hover,\\n.dash-sankey-node__selected,\\n.dash-sankey-link:hover,\\n.dash-sankey-link__selected {\\n  opacity: 0.5;\\n  fill: orange;\\n}\\n\\n.dash-sankey-layer-name {\\n  dominant-baseline: hanging;\\n  text-anchor: middle;\\n}\\n\\n.dash-sankey-layer-name__first {\\n  text-anchor: start;\\n}\\n\\n.dash-sankey-layer-name__last {\\n  text-anchor: end;\\n}\\n\\n.dash-sankey-facet-name {\\n  text-anchor: middle;\\n  writing-mode: vertical-lr;\\n}\\n\", \"\"]);\n// Exports\nmodule.exports = exports;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (useSourceMap) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item, useSourceMap);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join('');\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === 'string') {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, '']];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n  var content = item[1] || ''; // eslint-disable-next-line prefer-destructuring\n\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (useSourceMap && typeof btoa === 'function') {\n    var sourceMapping = toComment(cssMapping);\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || '').concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n  }\n\n  return [content].join('\\n');\n} // Adapted from convert-source-map (MIT)\n\n\nfunction toComment(sourceMap) {\n  // eslint-disable-next-line no-undef\n  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n  var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n  return \"/*# \".concat(data, \" */\");\n}","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getTarget = function (target, parent) {\n  if (parent){\n    return parent.querySelector(target);\n  }\n  return document.querySelector(target);\n};\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(target, parent) {\n                // If passing function in options, then use it for resolve \"head\" element.\n                // Useful for Shadow Root style i.e\n                // {\n                //   insertInto: function () { return document.querySelector(\"#foo\").shadowRoot }\n                // }\n                if (typeof target === 'function') {\n                        return target();\n                }\n                if (typeof memo[target] === \"undefined\") {\n\t\t\tvar styleTarget = getTarget.call(this, target, parent);\n\t\t\t// Special case to return head of iframe instead of iframe itself\n\t\t\tif (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n\t\t\t\ttry {\n\t\t\t\t\t// This will throw an exception if access to iframe is blocked\n\t\t\t\t\t// due to cross-origin restrictions\n\t\t\t\t\tstyleTarget = styleTarget.contentDocument.head;\n\t\t\t\t} catch(e) {\n\t\t\t\t\tstyleTarget = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemo[target] = styleTarget;\n\t\t}\n\t\treturn memo[target]\n\t};\n})();\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = require(\"./urls\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton && typeof options.singleton !== \"boolean\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n        if (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else if (typeof options.insertAt === \"object\" && options.insertAt.before) {\n\t\tvar nextSibling = getElement(options.insertAt.before, target);\n\t\ttarget.insertBefore(style, nextSibling);\n\t} else {\n\t\tthrow new Error(\"[Style Loader]\\n\\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\\n Must be 'top', 'bottom', or Object.\\n (https://github.com/webpack-contrib/style-loader#insertat)\\n\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\n\tif(options.attrs.nonce === undefined) {\n\t\tvar nonce = getNonce();\n\t\tif (nonce) {\n\t\t\toptions.attrs.nonce = nonce;\n\t\t}\n\t}\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction getNonce() {\n\tif (typeof __webpack_nonce__ === 'undefined') {\n\t\treturn null;\n\t}\n\n\treturn __webpack_nonce__;\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = typeof options.transform === 'function'\n\t\t ? options.transform(obj.css) \n\t\t : options.transform.default(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/|\\s*$)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n","import { useRef, useState, useEffect, useMemo, useCallback } from 'react';\n\n// This of course could've been more streamlined with internal state instead of\n// refs, but then host hooks / components could not opt out of renders.\n// This could've been exported to its own module, but the current build doesn't\n// seem to work with module imports and I had no more time to spend on this...\nfunction useResolvedElement(subscriber, refOrElement) {\n  var _ref;\n\n  // The default ref has to be non-conditionally declared here whether or not\n  // it'll be used as that's how hooks work.\n  // @see https://reactjs.org/docs/hooks-rules.html#explanation\n  var ref = null; // Default ref\n\n  var refElement = useRef(null);\n  var callbackRefElement = useRef(null);\n  var refCallback = useCallback(function (element) {\n    callbackRefElement.current = element;\n    callSubscriber();\n  }, []);\n  var lastReportedElementRef = useRef(null);\n  var cleanupRef = useRef();\n\n  var callSubscriber = function callSubscriber() {\n    var element = null;\n\n    if (callbackRefElement.current) {\n      element = callbackRefElement.current;\n    } else if (refElement.current) {\n      element = refElement.current;\n    } else if (refOrElement instanceof HTMLElement) {\n      element = refOrElement;\n    }\n\n    if (lastReportedElementRef.current === element) {\n      return;\n    }\n\n    if (cleanupRef.current) {\n      cleanupRef.current(); // Making sure the cleanup is not called accidentally multiple times.\n\n      cleanupRef.current = null;\n    }\n\n    lastReportedElementRef.current = element; // Only calling the subscriber, if there's an actual element to report.\n\n    if (element) {\n      cleanupRef.current = subscriber(element);\n    }\n  };\n\n  if (refOrElement && !(refOrElement instanceof HTMLElement)) {\n    // Overriding the default ref with the given one\n    ref = refOrElement;\n  } // On each render, we check whether a ref changed, or if we got a new raw\n  // element.\n\n\n  useEffect(function () {\n    // Note that this does not mean that \"element\" will necessarily be whatever\n    // the ref currently holds. It'll simply \"update\" `element` each render to\n    // the current ref value, but there's no guarantee that the ref value will\n    // not change later without a render.\n    // This may or may not be a problem depending on the specific use case.\n    if (ref) {\n      refElement.current = ref.current;\n    }\n\n    callSubscriber();\n  }, [ref, (_ref = ref) == null ? void 0 : _ref.current, refOrElement]);\n  return refCallback;\n}\n\nfunction useResizeObserver(opts) {\n  if (opts === void 0) {\n    opts = {};\n  }\n\n  // Saving the callback as a ref. With this, I don't need to put onResize in the\n  // effect dep array, and just passing in an anonymous function without memoising\n  // will not reinstantiate the hook's ResizeObserver\n  var onResize = opts.onResize;\n  var onResizeRef = useRef(undefined);\n  onResizeRef.current = onResize; // Using a single instance throughout the hook's lifetime\n\n  var resizeObserverRef = useRef();\n\n  var _useState = useState({\n    width: undefined,\n    height: undefined\n  }),\n      size = _useState[0],\n      setSize = _useState[1]; // In certain edge cases the RO might want to report a size change just after\n  // the component unmounted.\n\n\n  var didUnmount = useRef(false);\n  useEffect(function () {\n    return function () {\n      didUnmount.current = true;\n    };\n  }, []); // Using a ref to track the previous width / height to avoid unnecessary renders\n\n  var previous = useRef({\n    width: undefined,\n    height: undefined\n  }); // This block is kinda like a useEffect, only it's called whenever a new\n  // element could be resolved based on the ref option. It also has a cleanup\n  // function.\n\n  var refCallback = useResolvedElement(function (element) {\n    // Initialising the RO instance\n    if (!resizeObserverRef.current) {\n      // Saving a single instance, used by the hook from this point on.\n      resizeObserverRef.current = new ResizeObserver(function (entries) {\n        if (!Array.isArray(entries)) {\n          return;\n        } // Since we only observe the one element, we don't need to loop over the\n        // array\n\n\n        if (!entries.length) {\n          return;\n        }\n\n        var entry = entries[0]; // `Math.round` is in line with how CSS resolves sub-pixel values\n\n        var newWidth = Math.round(entry.contentRect.width);\n        var newHeight = Math.round(entry.contentRect.height);\n\n        if (previous.current.width !== newWidth || previous.current.height !== newHeight) {\n          var newSize = {\n            width: newWidth,\n            height: newHeight\n          };\n\n          if (onResizeRef.current) {\n            onResizeRef.current(newSize);\n          } else {\n            previous.current.width = newWidth;\n            previous.current.height = newHeight;\n\n            if (!didUnmount.current) {\n              setSize(newSize);\n            }\n          }\n        }\n      });\n    }\n\n    resizeObserverRef.current.observe(element);\n    return function () {\n      if (resizeObserverRef.current) {\n        resizeObserverRef.current.unobserve(element);\n      }\n    };\n  }, opts.ref);\n  return useMemo(function () {\n    return {\n      ref: refCallback,\n      width: size.width,\n      height: size.height\n    };\n  }, [refCallback, size ? size.width : null, size ? size.height : null]);\n}\n\nexport default useResizeObserver;\n","export default function sum(values, valueof) {\n  let sum = 0;\n  if (valueof === undefined) {\n    for (let value of values) {\n      if (value = +value) {\n        sum += value;\n      }\n    }\n  } else {\n    let index = -1;\n    for (let value of values) {\n      if (value = +valueof(value, ++index, values)) {\n        sum += value;\n      }\n    }\n  }\n  return sum;\n}\n","export default function max(values, valueof) {\n  let max;\n  if (valueof === undefined) {\n    for (const value of values) {\n      if (value != null\n          && (max < value || (max === undefined && value >= value))) {\n        max = value;\n      }\n    }\n  } else {\n    let index = -1;\n    for (let value of values) {\n      if ((value = valueof(value, ++index, values)) != null\n          && (max < value || (max === undefined && value >= value))) {\n        max = value;\n      }\n    }\n  }\n  return max;\n}\n","export default function min(values, valueof) {\n  let min;\n  if (valueof === undefined) {\n    for (const value of values) {\n      if (value != null\n          && (min > value || (min === undefined && value >= value))) {\n        min = value;\n      }\n    }\n  } else {\n    let index = -1;\n    for (let value of values) {\n      if ((value = valueof(value, ++index, values)) != null\n          && (min > value || (min === undefined && value >= value))) {\n        min = value;\n      }\n    }\n  }\n  return min;\n}\n","import {min} from \"d3-array\";\n\nfunction targetDepth(d) {\n  return d.target.depth;\n}\n\nexport function left(node) {\n  return node.depth;\n}\n\nexport function right(node, n) {\n  return n - 1 - node.height;\n}\n\nexport function justify(node, n) {\n  return node.sourceLinks.length ? node.depth : n - 1;\n}\n\nexport function center(node) {\n  return node.targetLinks.length ? node.depth\n      : node.sourceLinks.length ? min(node.sourceLinks, targetDepth) - 1\n      : 0;\n}\n","export default function constant(x) {\n  return function() {\n    return x;\n  };\n}\n","import {max, min, sum} from \"d3-array\";\nimport {justify} from \"./align.js\";\nimport constant from \"./constant.js\";\n\nfunction ascendingSourceBreadth(a, b) {\n  return ascendingBreadth(a.source, b.source) || a.index - b.index;\n}\n\nfunction ascendingTargetBreadth(a, b) {\n  return ascendingBreadth(a.target, b.target) || a.index - b.index;\n}\n\nfunction ascendingBreadth(a, b) {\n  return a.y0 - b.y0;\n}\n\nfunction value(d) {\n  return d.value;\n}\n\nfunction defaultId(d) {\n  return d.index;\n}\n\nfunction defaultNodes(graph) {\n  return graph.nodes;\n}\n\nfunction defaultLinks(graph) {\n  return graph.links;\n}\n\nfunction find(nodeById, id) {\n  const node = nodeById.get(id);\n  if (!node) throw new Error(\"missing: \" + id);\n  return node;\n}\n\nfunction computeLinkBreadths({nodes}) {\n  for (const node of nodes) {\n    let y0 = node.y0;\n    let y1 = y0;\n    for (const link of node.sourceLinks) {\n      link.y0 = y0 + link.width / 2;\n      y0 += link.width;\n    }\n    for (const link of node.targetLinks) {\n      link.y1 = y1 + link.width / 2;\n      y1 += link.width;\n    }\n  }\n}\n\nexport default function Sankey() {\n  let x0 = 0, y0 = 0, x1 = 1, y1 = 1; // extent\n  let dx = 24; // nodeWidth\n  let dy = 8, py; // nodePadding\n  let id = defaultId;\n  let align = justify;\n  let sort;\n  let linkSort;\n  let nodes = defaultNodes;\n  let links = defaultLinks;\n  let iterations = 6;\n\n  function sankey() {\n    const graph = {nodes: nodes.apply(null, arguments), links: links.apply(null, arguments)};\n    computeNodeLinks(graph);\n    computeNodeValues(graph);\n    computeNodeDepths(graph);\n    computeNodeHeights(graph);\n    computeNodeBreadths(graph);\n    computeLinkBreadths(graph);\n    return graph;\n  }\n\n  sankey.update = function(graph) {\n    computeLinkBreadths(graph);\n    return graph;\n  };\n\n  sankey.nodeId = function(_) {\n    return arguments.length ? (id = typeof _ === \"function\" ? _ : constant(_), sankey) : id;\n  };\n\n  sankey.nodeAlign = function(_) {\n    return arguments.length ? (align = typeof _ === \"function\" ? _ : constant(_), sankey) : align;\n  };\n\n  sankey.nodeSort = function(_) {\n    return arguments.length ? (sort = _, sankey) : sort;\n  };\n\n  sankey.nodeWidth = function(_) {\n    return arguments.length ? (dx = +_, sankey) : dx;\n  };\n\n  sankey.nodePadding = function(_) {\n    return arguments.length ? (dy = py = +_, sankey) : dy;\n  };\n\n  sankey.nodes = function(_) {\n    return arguments.length ? (nodes = typeof _ === \"function\" ? _ : constant(_), sankey) : nodes;\n  };\n\n  sankey.links = function(_) {\n    return arguments.length ? (links = typeof _ === \"function\" ? _ : constant(_), sankey) : links;\n  };\n\n  sankey.linkSort = function(_) {\n    return arguments.length ? (linkSort = _, sankey) : linkSort;\n  };\n\n  sankey.size = function(_) {\n    return arguments.length ? (x0 = y0 = 0, x1 = +_[0], y1 = +_[1], sankey) : [x1 - x0, y1 - y0];\n  };\n\n  sankey.extent = function(_) {\n    return arguments.length ? (x0 = +_[0][0], x1 = +_[1][0], y0 = +_[0][1], y1 = +_[1][1], sankey) : [[x0, y0], [x1, y1]];\n  };\n\n  sankey.iterations = function(_) {\n    return arguments.length ? (iterations = +_, sankey) : iterations;\n  };\n\n  function computeNodeLinks({nodes, links}) {\n    for (const [i, node] of nodes.entries()) {\n      node.index = i;\n      node.sourceLinks = [];\n      node.targetLinks = [];\n    }\n    const nodeById = new Map(nodes.map((d, i) => [id(d, i, nodes), d]));\n    for (const [i, link] of links.entries()) {\n      link.index = i;\n      let {source, target} = link;\n      if (typeof source !== \"object\") source = link.source = find(nodeById, source);\n      if (typeof target !== \"object\") target = link.target = find(nodeById, target);\n      source.sourceLinks.push(link);\n      target.targetLinks.push(link);\n    }\n    if (linkSort != null) {\n      for (const {sourceLinks, targetLinks} of nodes) {\n        sourceLinks.sort(linkSort);\n        targetLinks.sort(linkSort);\n      }\n    }\n  }\n\n  function computeNodeValues({nodes}) {\n    for (const node of nodes) {\n      node.value = node.fixedValue === undefined\n          ? Math.max(sum(node.sourceLinks, value), sum(node.targetLinks, value))\n          : node.fixedValue;\n    }\n  }\n\n  function computeNodeDepths({nodes}) {\n    const n = nodes.length;\n    let current = new Set(nodes);\n    let next = new Set;\n    let x = 0;\n    while (current.size) {\n      for (const node of current) {\n        node.depth = x;\n        for (const {target} of node.sourceLinks) {\n          next.add(target);\n        }\n      }\n      if (++x > n) throw new Error(\"circular link\");\n      current = next;\n      next = new Set;\n    }\n  }\n\n  function computeNodeHeights({nodes}) {\n    const n = nodes.length;\n    let current = new Set(nodes);\n    let next = new Set;\n    let x = 0;\n    while (current.size) {\n      for (const node of current) {\n        node.height = x;\n        for (const {source} of node.targetLinks) {\n          next.add(source);\n        }\n      }\n      if (++x > n) throw new Error(\"circular link\");\n      current = next;\n      next = new Set;\n    }\n  }\n\n  function computeNodeLayers({nodes}) {\n    const x = max(nodes, d => d.depth) + 1;\n    const kx = (x1 - x0 - dx) / (x - 1);\n    const columns = new Array(x);\n    for (const node of nodes) {\n      const i = Math.max(0, Math.min(x - 1, Math.floor(align.call(null, node, x))));\n      node.layer = i;\n      node.x0 = x0 + i * kx;\n      node.x1 = node.x0 + dx;\n      if (columns[i]) columns[i].push(node);\n      else columns[i] = [node];\n    }\n    if (sort) for (const column of columns) {\n      column.sort(sort);\n    }\n    return columns;\n  }\n\n  function initializeNodeBreadths(columns) {\n    const ky = min(columns, c => (y1 - y0 - (c.length - 1) * py) / sum(c, value));\n    for (const nodes of columns) {\n      let y = y0;\n      for (const node of nodes) {\n        node.y0 = y;\n        node.y1 = y + node.value * ky;\n        y = node.y1 + py;\n        for (const link of node.sourceLinks) {\n          link.width = link.value * ky;\n        }\n      }\n      y = (y1 - y + py) / (nodes.length + 1);\n      for (let i = 0; i < nodes.length; ++i) {\n        const node = nodes[i];\n        node.y0 += y * (i + 1);\n        node.y1 += y * (i + 1);\n      }\n      reorderLinks(nodes);\n    }\n  }\n\n  function computeNodeBreadths(graph) {\n    const columns = computeNodeLayers(graph);\n    py = Math.min(dy, (y1 - y0) / (max(columns, c => c.length) - 1));\n    initializeNodeBreadths(columns);\n    for (let i = 0; i < iterations; ++i) {\n      const alpha = Math.pow(0.99, i);\n      const beta = Math.max(1 - alpha, (i + 1) / iterations);\n      relaxRightToLeft(columns, alpha, beta);\n      relaxLeftToRight(columns, alpha, beta);\n    }\n  }\n\n  // Reposition each node based on its incoming (target) links.\n  function relaxLeftToRight(columns, alpha, beta) {\n    for (let i = 1, n = columns.length; i < n; ++i) {\n      const column = columns[i];\n      for (const target of column) {\n        let y = 0;\n        let w = 0;\n        for (const {source, value} of target.targetLinks) {\n          let v = value * (target.layer - source.layer);\n          y += targetTop(source, target) * v;\n          w += v;\n        }\n        if (!(w > 0)) continue;\n        let dy = (y / w - target.y0) * alpha;\n        target.y0 += dy;\n        target.y1 += dy;\n        reorderNodeLinks(target);\n      }\n      if (sort === undefined) column.sort(ascendingBreadth);\n      resolveCollisions(column, beta);\n    }\n  }\n\n  // Reposition each node based on its outgoing (source) links.\n  function relaxRightToLeft(columns, alpha, beta) {\n    for (let n = columns.length, i = n - 2; i >= 0; --i) {\n      const column = columns[i];\n      for (const source of column) {\n        let y = 0;\n        let w = 0;\n        for (const {target, value} of source.sourceLinks) {\n          let v = value * (target.layer - source.layer);\n          y += sourceTop(source, target) * v;\n          w += v;\n        }\n        if (!(w > 0)) continue;\n        let dy = (y / w - source.y0) * alpha;\n        source.y0 += dy;\n        source.y1 += dy;\n        reorderNodeLinks(source);\n      }\n      if (sort === undefined) column.sort(ascendingBreadth);\n      resolveCollisions(column, beta);\n    }\n  }\n\n  function resolveCollisions(nodes, alpha) {\n    const i = nodes.length >> 1;\n    const subject = nodes[i];\n    resolveCollisionsBottomToTop(nodes, subject.y0 - py, i - 1, alpha);\n    resolveCollisionsTopToBottom(nodes, subject.y1 + py, i + 1, alpha);\n    resolveCollisionsBottomToTop(nodes, y1, nodes.length - 1, alpha);\n    resolveCollisionsTopToBottom(nodes, y0, 0, alpha);\n  }\n\n  // Push any overlapping nodes down.\n  function resolveCollisionsTopToBottom(nodes, y, i, alpha) {\n    for (; i < nodes.length; ++i) {\n      const node = nodes[i];\n      const dy = (y - node.y0) * alpha;\n      if (dy > 1e-6) node.y0 += dy, node.y1 += dy;\n      y = node.y1 + py;\n    }\n  }\n\n  // Push any overlapping nodes up.\n  function resolveCollisionsBottomToTop(nodes, y, i, alpha) {\n    for (; i >= 0; --i) {\n      const node = nodes[i];\n      const dy = (node.y1 - y) * alpha;\n      if (dy > 1e-6) node.y0 -= dy, node.y1 -= dy;\n      y = node.y0 - py;\n    }\n  }\n\n  function reorderNodeLinks({sourceLinks, targetLinks}) {\n    if (linkSort === undefined) {\n      for (const {source: {sourceLinks}} of targetLinks) {\n        sourceLinks.sort(ascendingTargetBreadth);\n      }\n      for (const {target: {targetLinks}} of sourceLinks) {\n        targetLinks.sort(ascendingSourceBreadth);\n      }\n    }\n  }\n\n  function reorderLinks(nodes) {\n    if (linkSort === undefined) {\n      for (const {sourceLinks, targetLinks} of nodes) {\n        sourceLinks.sort(ascendingTargetBreadth);\n        targetLinks.sort(ascendingSourceBreadth);\n      }\n    }\n  }\n\n  // Returns the target.y0 that would produce an ideal link from source to target.\n  function targetTop(source, target) {\n    let y = source.y0 - (source.sourceLinks.length - 1) * py / 2;\n    for (const {target: node, width} of source.sourceLinks) {\n      if (node === target) break;\n      y += width + py;\n    }\n    for (const {source: node, width} of target.targetLinks) {\n      if (node === source) break;\n      y -= width;\n    }\n    return y;\n  }\n\n  // Returns the source.y0 that would produce an ideal link from source to target.\n  function sourceTop(source, target) {\n    let y = target.y0 - (target.targetLinks.length - 1) * py / 2;\n    for (const {source: node, width} of target.targetLinks) {\n      if (node === source) break;\n      y += width + py;\n    }\n    for (const {target: node, width} of source.sourceLinks) {\n      if (node === target) break;\n      y -= width;\n    }\n    return y;\n  }\n\n  return sankey;\n}\n","var pi = Math.PI,\n    tau = 2 * pi,\n    epsilon = 1e-6,\n    tauEpsilon = tau - epsilon;\n\nfunction Path() {\n  this._x0 = this._y0 = // start of current subpath\n  this._x1 = this._y1 = null; // end of current subpath\n  this._ = \"\";\n}\n\nfunction path() {\n  return new Path;\n}\n\nPath.prototype = path.prototype = {\n  constructor: Path,\n  moveTo: function(x, y) {\n    this._ += \"M\" + (this._x0 = this._x1 = +x) + \",\" + (this._y0 = this._y1 = +y);\n  },\n  closePath: function() {\n    if (this._x1 !== null) {\n      this._x1 = this._x0, this._y1 = this._y0;\n      this._ += \"Z\";\n    }\n  },\n  lineTo: function(x, y) {\n    this._ += \"L\" + (this._x1 = +x) + \",\" + (this._y1 = +y);\n  },\n  quadraticCurveTo: function(x1, y1, x, y) {\n    this._ += \"Q\" + (+x1) + \",\" + (+y1) + \",\" + (this._x1 = +x) + \",\" + (this._y1 = +y);\n  },\n  bezierCurveTo: function(x1, y1, x2, y2, x, y) {\n    this._ += \"C\" + (+x1) + \",\" + (+y1) + \",\" + (+x2) + \",\" + (+y2) + \",\" + (this._x1 = +x) + \",\" + (this._y1 = +y);\n  },\n  arcTo: function(x1, y1, x2, y2, r) {\n    x1 = +x1, y1 = +y1, x2 = +x2, y2 = +y2, r = +r;\n    var x0 = this._x1,\n        y0 = this._y1,\n        x21 = x2 - x1,\n        y21 = y2 - y1,\n        x01 = x0 - x1,\n        y01 = y0 - y1,\n        l01_2 = x01 * x01 + y01 * y01;\n\n    // Is the radius negative? Error.\n    if (r < 0) throw new Error(\"negative radius: \" + r);\n\n    // Is this path empty? Move to (x1,y1).\n    if (this._x1 === null) {\n      this._ += \"M\" + (this._x1 = x1) + \",\" + (this._y1 = y1);\n    }\n\n    // Or, is (x1,y1) coincident with (x0,y0)? Do nothing.\n    else if (!(l01_2 > epsilon));\n\n    // Or, are (x0,y0), (x1,y1) and (x2,y2) collinear?\n    // Equivalently, is (x1,y1) coincident with (x2,y2)?\n    // Or, is the radius zero? Line to (x1,y1).\n    else if (!(Math.abs(y01 * x21 - y21 * x01) > epsilon) || !r) {\n      this._ += \"L\" + (this._x1 = x1) + \",\" + (this._y1 = y1);\n    }\n\n    // Otherwise, draw an arc!\n    else {\n      var x20 = x2 - x0,\n          y20 = y2 - y0,\n          l21_2 = x21 * x21 + y21 * y21,\n          l20_2 = x20 * x20 + y20 * y20,\n          l21 = Math.sqrt(l21_2),\n          l01 = Math.sqrt(l01_2),\n          l = r * Math.tan((pi - Math.acos((l21_2 + l01_2 - l20_2) / (2 * l21 * l01))) / 2),\n          t01 = l / l01,\n          t21 = l / l21;\n\n      // If the start tangent is not coincident with (x0,y0), line to.\n      if (Math.abs(t01 - 1) > epsilon) {\n        this._ += \"L\" + (x1 + t01 * x01) + \",\" + (y1 + t01 * y01);\n      }\n\n      this._ += \"A\" + r + \",\" + r + \",0,0,\" + (+(y01 * x20 > x01 * y20)) + \",\" + (this._x1 = x1 + t21 * x21) + \",\" + (this._y1 = y1 + t21 * y21);\n    }\n  },\n  arc: function(x, y, r, a0, a1, ccw) {\n    x = +x, y = +y, r = +r, ccw = !!ccw;\n    var dx = r * Math.cos(a0),\n        dy = r * Math.sin(a0),\n        x0 = x + dx,\n        y0 = y + dy,\n        cw = 1 ^ ccw,\n        da = ccw ? a0 - a1 : a1 - a0;\n\n    // Is the radius negative? Error.\n    if (r < 0) throw new Error(\"negative radius: \" + r);\n\n    // Is this path empty? Move to (x0,y0).\n    if (this._x1 === null) {\n      this._ += \"M\" + x0 + \",\" + y0;\n    }\n\n    // Or, is (x0,y0) not coincident with the previous point? Line to (x0,y0).\n    else if (Math.abs(this._x1 - x0) > epsilon || Math.abs(this._y1 - y0) > epsilon) {\n      this._ += \"L\" + x0 + \",\" + y0;\n    }\n\n    // Is this arc empty? Were done.\n    if (!r) return;\n\n    // Does the angle go the wrong way? Flip the direction.\n    if (da < 0) da = da % tau + tau;\n\n    // Is this a complete circle? Draw two arcs to complete the circle.\n    if (da > tauEpsilon) {\n      this._ += \"A\" + r + \",\" + r + \",0,1,\" + cw + \",\" + (x - dx) + \",\" + (y - dy) + \"A\" + r + \",\" + r + \",0,1,\" + cw + \",\" + (this._x1 = x0) + \",\" + (this._y1 = y0);\n    }\n\n    // Is this arc non-empty? Draw an arc!\n    else if (da > epsilon) {\n      this._ += \"A\" + r + \",\" + r + \",0,\" + (+(da >= pi)) + \",\" + cw + \",\" + (this._x1 = x + r * Math.cos(a1)) + \",\" + (this._y1 = y + r * Math.sin(a1));\n    }\n  },\n  rect: function(x, y, w, h) {\n    this._ += \"M\" + (this._x0 = this._x1 = +x) + \",\" + (this._y0 = this._y1 = +y) + \"h\" + (+w) + \"v\" + (+h) + \"h\" + (-w) + \"Z\";\n  },\n  toString: function() {\n    return this._;\n  }\n};\n\nexport default path;\n","export var slice = Array.prototype.slice;\n","import PropTypes from 'prop-types';\n\nexport function classNames(...cs: (string | boolean | null | undefined)[]): string {\n  return cs.filter(Boolean).join(' ');\n}\n\nexport class OverlapHelper<T> {\n  private readonly set: Set<T>;\n\n  private givenIds: T[] | null;\n\n  readonly has: (v: T) => boolean;\n\n  constructor(ids: Iterable<T> | Set<T>) {\n    this.set = ids instanceof Set ? ids : new Set(ids);\n    this.givenIds = Array.isArray(ids) ? ids : null;\n    this.has = this.set.has.bind(this.set);\n  }\n\n  get elems(): T[] {\n    return this.givenIds ?? [...this.set];\n  }\n\n  get isEmpty(): boolean {\n    return this.set.size === 0;\n  }\n\n  get isNotEmpty(): boolean {\n    return this.set.size > 0;\n  }\n\n  get size(): number {\n    return this.set.size;\n  }\n\n  get length(): number {\n    return this.set.size;\n  }\n\n  intersect(v: Iterable<T> | OverlapHelper<T>): OverlapHelper<T> {\n    if (this.isEmpty) {\n      return this.copy();\n    }\n    if (this === v) {\n      return this.copy();\n    }\n\n    const r = new Set<T>();\n    if (v instanceof OverlapHelper) {\n      v.set.forEach((vi) => {\n        if (this.has(vi)) {\n          r.add(vi);\n        }\n      });\n    } else {\n      for (const vi of v) {\n        if (this.has(vi)) {\n          r.add(vi);\n        }\n      }\n    }\n    return new OverlapHelper(r);\n  }\n\n  copy(): OverlapHelper<T> {\n    return new OverlapHelper(this.givenIds ?? new Set(this.set));\n  }\n\n  intersectUpdate(v: Iterable<T> | OverlapHelper<T>): void {\n    if (this.isEmpty || this === v) {\n      return;\n    }\n    this.givenIds = null;\n\n    if (v instanceof OverlapHelper) {\n      if (v.isEmpty) {\n        this.set.clear();\n        return;\n      }\n      for (const elem of this.elems) {\n        if (!v.has(elem)) {\n          this.set.delete(elem);\n        }\n      }\n    } else {\n      const has = new Set(v);\n      for (const elem of this.elems) {\n        if (!has.has(elem)) {\n          this.set.delete(elem);\n        }\n      }\n    }\n  }\n\n  withoutUpdate(v: OverlapHelper<T>): void {\n    if (this.isEmpty || v.isEmpty) {\n      return;\n    }\n    this.givenIds = null;\n\n    for (const elem of this.elems) {\n      if (v.has(elem)) {\n        this.set.delete(elem);\n      }\n    }\n  }\n\n  without(v: OverlapHelper<T>): OverlapHelper<T> {\n    const r = this.copy();\n    r.withoutUpdate(v);\n    return r;\n  }\n\n  addUpdate(v: OverlapHelper<T>): void {\n    if (this === v || v.isEmpty) {\n      return;\n    }\n    this.givenIds = null;\n    for (const vi of v.set) {\n      this.set.add(vi);\n    }\n  }\n}\n\nexport interface IBox {\n  left: number;\n  top: number;\n  right: number;\n  bottom: number;\n}\n\nexport function deriveBox(p: number | IBox, defaultValue: IBox): IBox {\n  return {\n    ...defaultValue,\n    left: typeof p === 'number' ? p : p.left,\n    right: typeof p === 'number' ? p : p.right,\n    top: typeof p === 'number' ? p : p.top,\n    bottom: typeof p === 'number' ? p : p.bottom,\n  };\n}\n\nexport const PADDING_PROP_TYPES = PropTypes.oneOfType([\n  PropTypes.number.isRequired,\n  PropTypes.shape({\n    left: PropTypes.number.isRequired,\n    top: PropTypes.number.isRequired,\n    right: PropTypes.number.isRequired,\n    bottom: PropTypes.number.isRequired,\n  }).isRequired,\n]);\n\nexport function isArray<T>(a: unknown): a is readonly T[] {\n  return Array.isArray(a);\n}\n\nexport function noop(): void {\n  // dummy\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const EMPTY_ARR: any[] = [];\n","/* eslint-disable @typescript-eslint/no-non-null-assertion */\nimport type { SankeyLink as SankeyLinkImpl, SankeyNode as SankeyNodeImpl } from 'd3-sankey';\nimport { IBox, isArray, OverlapHelper } from '../../utils';\n\nexport type SankeyID = string | number;\n\nexport interface HasIds {\n  ids: readonly SankeyID[];\n}\nexport interface SankeyNode extends HasIds {\n  id: string;\n  name: string;\n  layer?: number;\n}\n\nexport interface SankeyLayer {\n  name: string;\n  nodes: SankeyNode[];\n}\n\nexport interface SankeyLink {\n  id?: string;\n  source: string;\n  target: string;\n  ids?: readonly SankeyID[];\n}\n\nexport interface SankeySelection {\n  type: 'node' | 'link' | 'layer' | 'missing_in' | 'missing_out';\n  id: string;\n  ids: readonly SankeyID[];\n}\n\nexport interface FacettedSankeySelection extends SankeySelection {\n  facet: string;\n}\n\nexport interface SankeyExtraSelection {\n  color: string;\n  ids: readonly SankeyID[];\n  layers?: readonly SankeyID[];\n}\n\nexport const DEFAULT_PADDING: IBox = { left: 5, top: 5, right: 5, bottom: 20 };\n\nexport declare interface SankeyInternalNodeExtras extends SankeyNode {\n  id: string;\n  fixedValue: number;\n  overlap: OverlapHelper<SankeyID>;\n  /**\n   * ids that are not part of any incoming link\n   */\n  missingIn: OverlapHelper<SankeyID>;\n  /**\n   * ids that are not part of any outgoing link\n   */\n  missingOut: OverlapHelper<SankeyID>;\n}\n\nexport declare interface SankeyInternalLinkExtras {\n  id: string;\n  name: string;\n  overlap: OverlapHelper<SankeyID>;\n}\nexport declare type SankeyInternalNode = SankeyNodeImpl<SankeyInternalNodeExtras, SankeyInternalLinkExtras>;\nexport declare type SankeyInternalLink = SankeyLinkImpl<SankeyInternalNodeExtras, SankeyInternalLinkExtras>;\n\nexport interface SankeyInternalLayer {\n  id: string;\n  nodes: SankeyInternalNode[];\n  name: string;\n  overlap: OverlapHelper<SankeyID>;\n\n  x0: number;\n  x1: number;\n  y0: number;\n  y1: number;\n}\n\n// eslint-disable-next-line prettier/prettier\nexport function extractLayers(\n  nodes: readonly SankeyInternalNode[],\n  layers?: readonly SankeyLayer[]\n): SankeyInternalLayer[] {\n  const internalLayers: SankeyInternalLayer[] = [];\n\n  // depth is not a good indicator for layer -> x positions is\n  const xPositions = [...new Set(nodes.map((d) => d.x0!))].sort((a, b) => a - b);\n  const xPositionToLayer = new Map(xPositions.map((x, i) => [x, i]));\n\n  for (const node of nodes) {\n    const layer = node.layer ?? xPositionToLayer.get(node.x0!) ?? 0;\n    node.layer = layer; // save layer\n\n    const l = internalLayers[layer];\n    if (l == null) {\n      internalLayers[layer] = {\n        id: layer.toString(),\n        name: layers?.[layer]?.name ?? `Layer ${layer}`,\n        overlap: node.overlap.copy(),\n        x0: node.x0!,\n        x1: node.x1!,\n        y0: node.y0!,\n        y1: node.y1!,\n        nodes: [node],\n      };\n    } else {\n      l.overlap.addUpdate(node.overlap);\n      l.y0 = Math.min(l.y0, node.y0!);\n      l.y1 = Math.max(l.y1, node.y1!);\n      l.nodes.push(node);\n    }\n  }\n  return internalLayers;\n}\n\nexport function extractGraph(data: {\n  layers?: readonly SankeyLayer[];\n  nodes?: readonly SankeyNode[];\n  links?: readonly SankeyLink[];\n}): {\n  nodes: SankeyInternalNode[];\n  links: SankeyInternalLink[];\n  layers: SankeyInternalLayer[];\n  getOverlap(type: SankeySelection['type'], id: string): OverlapHelper<SankeyID>;\n} {\n  const lookup = new Map<string, OverlapHelper<SankeyID>>();\n  const nodes: SankeyInternalNode[] = [];\n  const links: SankeyInternalLink[] = [];\n\n  function asNode(d: SankeyNode, layer?: number) {\n    const overlap = new OverlapHelper(d.ids);\n    lookup.set(`node:${d.id}`, overlap);\n    const missingIn = overlap.copy();\n    const missingOut = overlap.copy();\n    lookup.set(`missing_in:${d.id}`, missingIn);\n    lookup.set(`missing_out:${d.id}`, missingOut);\n    const n: SankeyInternalNode = {\n      layer,\n      ...d,\n      overlap,\n      fixedValue: d.ids.length,\n      missingIn,\n      missingOut,\n    };\n    nodes.push(n);\n    return n;\n  }\n\n  function asLink(\n    source: SankeyInternalNode,\n    target: SankeyInternalNode,\n    overlap: OverlapHelper<SankeyID>,\n    id?: string\n  ) {\n    if (overlap.isEmpty) {\n      return undefined;\n    }\n    source.missingOut.withoutUpdate(overlap);\n    target.missingIn.withoutUpdate(overlap);\n    const linkId = id ?? `${source.id}/${target.id}`;\n    lookup.set(`link:${linkId}`, overlap);\n    const l: SankeyInternalLink = {\n      id: linkId,\n      name: `${source.name}  ${target.name}`,\n      value: overlap.size,\n      overlap,\n      source: source.id,\n      target: target.id,\n    };\n    links.push(l);\n    return l;\n  }\n\n  if (data.layers) {\n    const transformedLevels = data.layers.map((layer, i) => {\n      return layer.nodes.map((d) => asNode(d, i));\n    });\n\n    for (let i = 0; i < transformedLevels.length - 1; i += 1) {\n      const left = transformedLevels[i];\n      const right = transformedLevels[i + 1];\n      for (const source of left) {\n        for (const target of right) {\n          asLink(source, target, source.overlap.intersect(target.overlap));\n        }\n      }\n    }\n  }\n\n  if (data.nodes) {\n    for (const node of data.nodes) {\n      asNode(node);\n    }\n  }\n  if (data.links) {\n    const lookupNode = new Map(nodes.map((d) => [d.id, d]));\n    for (const link of data.links) {\n      const source = lookupNode.get(link.source)!;\n      const target = lookupNode.get(link.target)!;\n      const overlap = link.ids ? new OverlapHelper(link.ids) : source.overlap.intersect(target.overlap);\n      asLink(source, target, overlap, link.id);\n    }\n  }\n  const layers = extractLayers(nodes, data.layers);\n  for (const layer of layers) {\n    lookup.set(`layer:${layer.id}`, layer.overlap);\n  }\n  return {\n    nodes,\n    links,\n    layers,\n    getOverlap: (type, id) => {\n      return lookup.get(`${type}:${id}`) ?? new OverlapHelper<SankeyID>([]);\n    },\n  };\n}\n\nexport function isSelected(\n  selection: readonly SankeyID[] | SankeySelection | undefined,\n  type: SankeySelection['type'],\n  id: string\n): boolean {\n  return selection != null && !isArray(selection) && selection.type === type && selection.id === id;\n}\n","import { sankey, sankeyCenter, sankeyJustify, sankeyLeft, sankeyRight } from 'd3-sankey';\nimport React, { useCallback, useMemo, useState } from 'react';\nimport { deriveBox, IBox, isArray, noop, OverlapHelper } from '../../utils';\nimport {\n  extractGraph,\n  extractLayers,\n  isSelected,\n  SankeyExtraSelection,\n  SankeyID,\n  SankeyInternalLayer,\n  SankeyInternalLink,\n  SankeyInternalNode,\n  SankeySelection,\n} from './model';\n\nconst DEFAULT_PADDING: IBox = { left: 5, top: 5, right: 5, bottom: 20 };\n\nexport interface SankeyLayoutOptions {\n  /**\n   * @default fit to the width\n   */\n  width?: number;\n  /**\n   * @default 300\n   */\n  height?: number;\n  /**\n   * padding around SVG\n   * @default ({left: 5, top: 5, right: 5, bottom: 20})\n   */\n  padding?: number | IBox;\n  /**\n   * sets the number of relaxation iterations when generating the layout and returns this Sankey generator.\n   * @default 6\n   */\n  iterations?: number;\n  /**\n   * sets the node width to the specified number and returns this Sankey generator.\n   * @default 24\n   */\n  nodeWidth?: number;\n  /**\n   *  sets the vertical separation between nodes at each column to the specified number and returns this Sankey generator.\n   * @default 8\n   */\n  nodePadding?: number;\n  /**\n   * justify method\n   * @default 'lyaer' if layers else 'justify';\n   */\n  nodeAlign?: 'left' | 'right' | 'center' | 'justify' | 'layer';\n  /**\n   * node sort order\n   * @default 'auto'\n   */\n  nodeSort?: 'auto' | 'fixed';\n}\n\nfunction alignLayer(node: SankeyInternalNode, n: number) {\n  return node.layer ?? sankeyJustify(node, n);\n}\n\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport function useSankeyLayout(\n  { layers, nodes, links }: Parameters<typeof extractGraph>[0],\n  {\n    width = 500,\n    height = 300,\n    padding = DEFAULT_PADDING,\n    iterations = 6,\n    nodeAlign = layers ? 'layer' : 'justify',\n    nodePadding = 8,\n    nodeWidth = 24,\n    nodeSort = 'auto',\n  }: SankeyLayoutOptions\n) {\n  const p = useMemo(() => deriveBox(padding, DEFAULT_PADDING), [padding]);\n  const sankeyGen = useMemo(() => {\n    const s = sankey<SankeyInternalNode, SankeyInternalLink>();\n    s.extent([\n      [p.left, p.top],\n      [width - p.left - p.right, height - p.top - p.bottom],\n    ]);\n    const alignmentsToFunction = {\n      left: sankeyLeft,\n      right: sankeyRight,\n      center: sankeyCenter,\n      justify: sankeyJustify,\n      layer: alignLayer,\n    };\n    s.nodeId((n) => n.id);\n    s.iterations(iterations)\n      .nodeAlign(alignmentsToFunction[nodeAlign])\n      .nodeWidth(nodeWidth)\n      .nodePadding(nodePadding)\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      .nodeSort(nodeSort === 'auto' ? undefined : (null as any));\n    return s;\n  }, [p, width, height, iterations, nodeAlign, nodeWidth, nodePadding, nodeSort]);\n\n  const graph = useMemo(() => extractGraph({ layers, nodes, links }), [layers, nodes, links]);\n  const layoutGraph = useMemo(() => {\n    if (graph.nodes.length === 0) {\n      return {\n        nodes: [],\n        links: [],\n        layers: [],\n      };\n    }\n    const g = sankeyGen({\n      // work on copy since manipulated in place\n      nodes: graph.nodes.map((d) => ({ ...d })),\n      links: graph.links.map((d) => ({ ...d })),\n    });\n    return {\n      nodes: g.nodes,\n      links: g.links,\n      layers: extractLayers(g.nodes, layers),\n    };\n  }, [graph, sankeyGen, layers]);\n\n  const maxLayerY1 = layoutGraph.layers.reduce((acc, v) => Math.max(acc, v.y1), 0);\n\n  return { layoutGraph, graph, maxLayerY1, nodeWidth };\n}\n\nconst EMPTY_ARR: { color: string; ids: readonly SankeyID[] }[] = [];\n\nexport interface SankeySelections {\n  overlap: OverlapHelper<SankeyID>;\n  isSelected(type: SankeySelection['type'], id: string): boolean;\n  onClick(e: React.MouseEvent<HTMLElement | SVGElement>): void;\n  onMouseEnter(e: React.MouseEvent<HTMLElement | SVGElement>): void;\n  onMouseLeave(e: React.MouseEvent<HTMLElement | SVGElement>): void;\n  others: { overlap: OverlapHelper<SankeyID>; color: string; matchLayer(layer: number): boolean }[];\n}\n\nfunction matchLayerHelper(layers: readonly (string | number)[] | undefined, graphLayers: SankeyInternalLayer[]) {\n  if (!layers || layers.length === 0) {\n    return () => true;\n  }\n  const selectedIndices = new Set<number>();\n  graphLayers.forEach((l, i) => {\n    if (layers.includes(l.name) || layers.includes(l.id) || layers.includes(i)) {\n      selectedIndices.add(i);\n    }\n  });\n  return selectedIndices.has.bind(selectedIndices);\n}\n\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport function useSelections(\n  graph: ReturnType<typeof extractGraph>,\n  {\n    selection,\n    selections = EMPTY_ARR,\n    setProps = noop,\n  }: {\n    selection?: SankeySelection | readonly SankeyID[];\n    selections?: SankeyExtraSelection[];\n    setProps?(props: { selection?: SankeySelection | readonly SankeyID[] }): void;\n  }\n) {\n  const selectionsOverlaps = useMemo(\n    () =>\n      (selections ?? []).map((s) => ({\n        ...s,\n        overlap: new OverlapHelper(s.ids),\n        matchLayer: matchLayerHelper(s.layers, graph.layers),\n      })),\n    [selections, graph.layers]\n  );\n\n  const selectionOverlap = useMemo(\n    () => new OverlapHelper(isArray(selection) ? selection : selection?.ids ?? []),\n    [selection]\n  );\n\n  const onClick = useCallback(\n    (e: React.MouseEvent<HTMLElement | SVGElement>) => {\n      e.preventDefault();\n      e.stopPropagation();\n      const id = e.currentTarget.dataset.id ?? '';\n      const type = (e.currentTarget.dataset.type ?? 'node') as SankeySelection['type'];\n      const overlap = graph.getOverlap(type, id);\n      setProps({ selection: { id, type, ids: overlap.elems } });\n    },\n    [graph, setProps]\n  );\n  const [hoveredSelection, setHoveredSelection] =\n    useState<{ id: string; type: string; overlap: OverlapHelper<SankeyID> } | null>(null);\n\n  const onMouseEnter = useCallback(\n    (e: React.MouseEvent<HTMLElement | SVGElement>) => {\n      const id = e.currentTarget.dataset.id ?? '';\n      const type = (e.currentTarget.dataset.type ?? 'node') as SankeySelection['type'];\n      const overlap = graph.getOverlap(type, id);\n      setHoveredSelection({ id, type, overlap });\n    },\n    [setHoveredSelection, graph]\n  );\n  const onMouseLeave = useCallback(() => {\n    setHoveredSelection(null);\n  }, [setHoveredSelection]);\n\n  const selectionContext: SankeySelections = useMemo(\n    () => ({\n      isSelected: (type, sId) =>\n        hoveredSelection\n          ? hoveredSelection.id === sId && hoveredSelection.type === type\n          : isSelected(selection, type, sId),\n      others: selectionsOverlaps,\n      overlap: hoveredSelection?.overlap ?? selectionOverlap,\n      onClick,\n      onMouseEnter,\n      onMouseLeave,\n    }),\n    [onClick, onMouseEnter, onMouseLeave, hoveredSelection, selectionOverlap, selectionsOverlaps, selection]\n  );\n\n  return selectionContext;\n}\n","const pi = Math.PI,\n    tau = 2 * pi,\n    epsilon = 1e-6,\n    tauEpsilon = tau - epsilon;\n\nfunction Path() {\n  this._x0 = this._y0 = // start of current subpath\n  this._x1 = this._y1 = null; // end of current subpath\n  this._ = \"\";\n}\n\nfunction path() {\n  return new Path;\n}\n\nPath.prototype = path.prototype = {\n  constructor: Path,\n  moveTo: function(x, y) {\n    this._ += \"M\" + (this._x0 = this._x1 = +x) + \",\" + (this._y0 = this._y1 = +y);\n  },\n  closePath: function() {\n    if (this._x1 !== null) {\n      this._x1 = this._x0, this._y1 = this._y0;\n      this._ += \"Z\";\n    }\n  },\n  lineTo: function(x, y) {\n    this._ += \"L\" + (this._x1 = +x) + \",\" + (this._y1 = +y);\n  },\n  quadraticCurveTo: function(x1, y1, x, y) {\n    this._ += \"Q\" + (+x1) + \",\" + (+y1) + \",\" + (this._x1 = +x) + \",\" + (this._y1 = +y);\n  },\n  bezierCurveTo: function(x1, y1, x2, y2, x, y) {\n    this._ += \"C\" + (+x1) + \",\" + (+y1) + \",\" + (+x2) + \",\" + (+y2) + \",\" + (this._x1 = +x) + \",\" + (this._y1 = +y);\n  },\n  arcTo: function(x1, y1, x2, y2, r) {\n    x1 = +x1, y1 = +y1, x2 = +x2, y2 = +y2, r = +r;\n    var x0 = this._x1,\n        y0 = this._y1,\n        x21 = x2 - x1,\n        y21 = y2 - y1,\n        x01 = x0 - x1,\n        y01 = y0 - y1,\n        l01_2 = x01 * x01 + y01 * y01;\n\n    // Is the radius negative? Error.\n    if (r < 0) throw new Error(\"negative radius: \" + r);\n\n    // Is this path empty? Move to (x1,y1).\n    if (this._x1 === null) {\n      this._ += \"M\" + (this._x1 = x1) + \",\" + (this._y1 = y1);\n    }\n\n    // Or, is (x1,y1) coincident with (x0,y0)? Do nothing.\n    else if (!(l01_2 > epsilon));\n\n    // Or, are (x0,y0), (x1,y1) and (x2,y2) collinear?\n    // Equivalently, is (x1,y1) coincident with (x2,y2)?\n    // Or, is the radius zero? Line to (x1,y1).\n    else if (!(Math.abs(y01 * x21 - y21 * x01) > epsilon) || !r) {\n      this._ += \"L\" + (this._x1 = x1) + \",\" + (this._y1 = y1);\n    }\n\n    // Otherwise, draw an arc!\n    else {\n      var x20 = x2 - x0,\n          y20 = y2 - y0,\n          l21_2 = x21 * x21 + y21 * y21,\n          l20_2 = x20 * x20 + y20 * y20,\n          l21 = Math.sqrt(l21_2),\n          l01 = Math.sqrt(l01_2),\n          l = r * Math.tan((pi - Math.acos((l21_2 + l01_2 - l20_2) / (2 * l21 * l01))) / 2),\n          t01 = l / l01,\n          t21 = l / l21;\n\n      // If the start tangent is not coincident with (x0,y0), line to.\n      if (Math.abs(t01 - 1) > epsilon) {\n        this._ += \"L\" + (x1 + t01 * x01) + \",\" + (y1 + t01 * y01);\n      }\n\n      this._ += \"A\" + r + \",\" + r + \",0,0,\" + (+(y01 * x20 > x01 * y20)) + \",\" + (this._x1 = x1 + t21 * x21) + \",\" + (this._y1 = y1 + t21 * y21);\n    }\n  },\n  arc: function(x, y, r, a0, a1, ccw) {\n    x = +x, y = +y, r = +r, ccw = !!ccw;\n    var dx = r * Math.cos(a0),\n        dy = r * Math.sin(a0),\n        x0 = x + dx,\n        y0 = y + dy,\n        cw = 1 ^ ccw,\n        da = ccw ? a0 - a1 : a1 - a0;\n\n    // Is the radius negative? Error.\n    if (r < 0) throw new Error(\"negative radius: \" + r);\n\n    // Is this path empty? Move to (x0,y0).\n    if (this._x1 === null) {\n      this._ += \"M\" + x0 + \",\" + y0;\n    }\n\n    // Or, is (x0,y0) not coincident with the previous point? Line to (x0,y0).\n    else if (Math.abs(this._x1 - x0) > epsilon || Math.abs(this._y1 - y0) > epsilon) {\n      this._ += \"L\" + x0 + \",\" + y0;\n    }\n\n    // Is this arc empty? Were done.\n    if (!r) return;\n\n    // Does the angle go the wrong way? Flip the direction.\n    if (da < 0) da = da % tau + tau;\n\n    // Is this a complete circle? Draw two arcs to complete the circle.\n    if (da > tauEpsilon) {\n      this._ += \"A\" + r + \",\" + r + \",0,1,\" + cw + \",\" + (x - dx) + \",\" + (y - dy) + \"A\" + r + \",\" + r + \",0,1,\" + cw + \",\" + (this._x1 = x0) + \",\" + (this._y1 = y0);\n    }\n\n    // Is this arc non-empty? Draw an arc!\n    else if (da > epsilon) {\n      this._ += \"A\" + r + \",\" + r + \",0,\" + (+(da >= pi)) + \",\" + cw + \",\" + (this._x1 = x + r * Math.cos(a1)) + \",\" + (this._y1 = y + r * Math.sin(a1));\n    }\n  },\n  rect: function(x, y, w, h) {\n    this._ += \"M\" + (this._x0 = this._x1 = +x) + \",\" + (this._y0 = this._y1 = +y) + \"h\" + (+w) + \"v\" + (+h) + \"h\" + (-w) + \"Z\";\n  },\n  toString: function() {\n    return this._;\n  }\n};\n\nexport default path;\n","export var slice = Array.prototype.slice;\n\nexport default function(x) {\n  return typeof x === \"object\" && \"length\" in x\n    ? x // Array, TypedArray, NodeList, array-like\n    : Array.from(x); // Map, Set, iterable, string, or anything else\n}\n","export default function(x) {\n  return function constant() {\n    return x;\n  };\n}\n","function Linear(context) {\n  this._context = context;\n}\n\nLinear.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; // proceed\n      default: this._context.lineTo(x, y); break;\n    }\n  }\n};\n\nexport default function(context) {\n  return new Linear(context);\n}\n","export function x(p) {\n  return p[0];\n}\n\nexport function y(p) {\n  return p[1];\n}\n","import {path} from \"d3-path\";\nimport array from \"./array.js\";\nimport constant from \"./constant.js\";\nimport curveLinear from \"./curve/linear.js\";\nimport {x as pointX, y as pointY} from \"./point.js\";\n\nexport default function(x, y) {\n  var defined = constant(true),\n      context = null,\n      curve = curveLinear,\n      output = null;\n\n  x = typeof x === \"function\" ? x : (x === undefined) ? pointX : constant(x);\n  y = typeof y === \"function\" ? y : (y === undefined) ? pointY : constant(y);\n\n  function line(data) {\n    var i,\n        n = (data = array(data)).length,\n        d,\n        defined0 = false,\n        buffer;\n\n    if (context == null) output = curve(buffer = path());\n\n    for (i = 0; i <= n; ++i) {\n      if (!(i < n && defined(d = data[i], i, data)) === defined0) {\n        if (defined0 = !defined0) output.lineStart();\n        else output.lineEnd();\n      }\n      if (defined0) output.point(+x(d, i, data), +y(d, i, data));\n    }\n\n    if (buffer) return output = null, buffer + \"\" || null;\n  }\n\n  line.x = function(_) {\n    return arguments.length ? (x = typeof _ === \"function\" ? _ : constant(+_), line) : x;\n  };\n\n  line.y = function(_) {\n    return arguments.length ? (y = typeof _ === \"function\" ? _ : constant(+_), line) : y;\n  };\n\n  line.defined = function(_) {\n    return arguments.length ? (defined = typeof _ === \"function\" ? _ : constant(!!_), line) : defined;\n  };\n\n  line.curve = function(_) {\n    return arguments.length ? (curve = _, context != null && (output = curve(context)), line) : curve;\n  };\n\n  line.context = function(_) {\n    return arguments.length ? (_ == null ? context = output = null : output = curve(context = _), line) : context;\n  };\n\n  return line;\n}\n","import {path} from \"d3-path\";\nimport array from \"./array.js\";\nimport constant from \"./constant.js\";\nimport curveLinear from \"./curve/linear.js\";\nimport line from \"./line.js\";\nimport {x as pointX, y as pointY} from \"./point.js\";\n\nexport default function(x0, y0, y1) {\n  var x1 = null,\n      defined = constant(true),\n      context = null,\n      curve = curveLinear,\n      output = null;\n\n  x0 = typeof x0 === \"function\" ? x0 : (x0 === undefined) ? pointX : constant(+x0);\n  y0 = typeof y0 === \"function\" ? y0 : (y0 === undefined) ? constant(0) : constant(+y0);\n  y1 = typeof y1 === \"function\" ? y1 : (y1 === undefined) ? pointY : constant(+y1);\n\n  function area(data) {\n    var i,\n        j,\n        k,\n        n = (data = array(data)).length,\n        d,\n        defined0 = false,\n        buffer,\n        x0z = new Array(n),\n        y0z = new Array(n);\n\n    if (context == null) output = curve(buffer = path());\n\n    for (i = 0; i <= n; ++i) {\n      if (!(i < n && defined(d = data[i], i, data)) === defined0) {\n        if (defined0 = !defined0) {\n          j = i;\n          output.areaStart();\n          output.lineStart();\n        } else {\n          output.lineEnd();\n          output.lineStart();\n          for (k = i - 1; k >= j; --k) {\n            output.point(x0z[k], y0z[k]);\n          }\n          output.lineEnd();\n          output.areaEnd();\n        }\n      }\n      if (defined0) {\n        x0z[i] = +x0(d, i, data), y0z[i] = +y0(d, i, data);\n        output.point(x1 ? +x1(d, i, data) : x0z[i], y1 ? +y1(d, i, data) : y0z[i]);\n      }\n    }\n\n    if (buffer) return output = null, buffer + \"\" || null;\n  }\n\n  function arealine() {\n    return line().defined(defined).curve(curve).context(context);\n  }\n\n  area.x = function(_) {\n    return arguments.length ? (x0 = typeof _ === \"function\" ? _ : constant(+_), x1 = null, area) : x0;\n  };\n\n  area.x0 = function(_) {\n    return arguments.length ? (x0 = typeof _ === \"function\" ? _ : constant(+_), area) : x0;\n  };\n\n  area.x1 = function(_) {\n    return arguments.length ? (x1 = _ == null ? null : typeof _ === \"function\" ? _ : constant(+_), area) : x1;\n  };\n\n  area.y = function(_) {\n    return arguments.length ? (y0 = typeof _ === \"function\" ? _ : constant(+_), y1 = null, area) : y0;\n  };\n\n  area.y0 = function(_) {\n    return arguments.length ? (y0 = typeof _ === \"function\" ? _ : constant(+_), area) : y0;\n  };\n\n  area.y1 = function(_) {\n    return arguments.length ? (y1 = _ == null ? null : typeof _ === \"function\" ? _ : constant(+_), area) : y1;\n  };\n\n  area.lineX0 =\n  area.lineY0 = function() {\n    return arealine().x(x0).y(y0);\n  };\n\n  area.lineY1 = function() {\n    return arealine().x(x0).y(y1);\n  };\n\n  area.lineX1 = function() {\n    return arealine().x(x1).y(y0);\n  };\n\n  area.defined = function(_) {\n    return arguments.length ? (defined = typeof _ === \"function\" ? _ : constant(!!_), area) : defined;\n  };\n\n  area.curve = function(_) {\n    return arguments.length ? (curve = _, context != null && (output = curve(context)), area) : curve;\n  };\n\n  area.context = function(_) {\n    return arguments.length ? (_ == null ? context = output = null : output = curve(context = _), area) : context;\n  };\n\n  return area;\n}\n","function sign(x) {\n  return x < 0 ? -1 : 1;\n}\n\n// Calculate the slopes of the tangents (Hermite-type interpolation) based on\n// the following paper: Steffen, M. 1990. A Simple Method for Monotonic\n// Interpolation in One Dimension. Astronomy and Astrophysics, Vol. 239, NO.\n// NOV(II), P. 443, 1990.\nfunction slope3(that, x2, y2) {\n  var h0 = that._x1 - that._x0,\n      h1 = x2 - that._x1,\n      s0 = (that._y1 - that._y0) / (h0 || h1 < 0 && -0),\n      s1 = (y2 - that._y1) / (h1 || h0 < 0 && -0),\n      p = (s0 * h1 + s1 * h0) / (h0 + h1);\n  return (sign(s0) + sign(s1)) * Math.min(Math.abs(s0), Math.abs(s1), 0.5 * Math.abs(p)) || 0;\n}\n\n// Calculate a one-sided slope.\nfunction slope2(that, t) {\n  var h = that._x1 - that._x0;\n  return h ? (3 * (that._y1 - that._y0) / h - t) / 2 : t;\n}\n\n// According to https://en.wikipedia.org/wiki/Cubic_Hermite_spline#Representations\n// \"you can express cubic Hermite interpolation in terms of cubic Bzier curves\n// with respect to the four values p0, p0 + m0 / 3, p1 - m1 / 3, p1\".\nfunction point(that, t0, t1) {\n  var x0 = that._x0,\n      y0 = that._y0,\n      x1 = that._x1,\n      y1 = that._y1,\n      dx = (x1 - x0) / 3;\n  that._context.bezierCurveTo(x0 + dx, y0 + dx * t0, x1 - dx, y1 - dx * t1, x1, y1);\n}\n\nfunction MonotoneX(context) {\n  this._context = context;\n}\n\nMonotoneX.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 =\n    this._y0 = this._y1 =\n    this._t0 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 2: this._context.lineTo(this._x1, this._y1); break;\n      case 3: point(this, this._t0, slope2(this, this._t0)); break;\n    }\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    var t1 = NaN;\n\n    x = +x, y = +y;\n    if (x === this._x1 && y === this._y1) return; // Ignore coincident points.\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; point(this, slope2(this, t1 = slope3(this, x, y)), t1); break;\n      default: point(this, this._t0, t1 = slope3(this, x, y)); break;\n    }\n\n    this._x0 = this._x1, this._x1 = x;\n    this._y0 = this._y1, this._y1 = y;\n    this._t0 = t1;\n  }\n}\n\nfunction MonotoneY(context) {\n  this._context = new ReflectContext(context);\n}\n\n(MonotoneY.prototype = Object.create(MonotoneX.prototype)).point = function(x, y) {\n  MonotoneX.prototype.point.call(this, y, x);\n};\n\nfunction ReflectContext(context) {\n  this._context = context;\n}\n\nReflectContext.prototype = {\n  moveTo: function(x, y) { this._context.moveTo(y, x); },\n  closePath: function() { this._context.closePath(); },\n  lineTo: function(x, y) { this._context.lineTo(y, x); },\n  bezierCurveTo: function(x1, y1, x2, y2, x, y) { this._context.bezierCurveTo(y1, x1, y2, x2, y, x); }\n};\n\nexport function monotoneX(context) {\n  return new MonotoneX(context);\n}\n\nexport function monotoneY(context) {\n  return new MonotoneY(context);\n}\n","/* eslint-disable @typescript-eslint/no-non-null-assertion */\nimport { area, curveMonotoneX } from 'd3-shape';\nimport type { SankeyInternalLink, SankeyInternalNode } from './model';\n\nfunction missingInOffset(node: SankeyInternalNode): number {\n  const y0 = node.y0!;\n  const y1 = y0 + (node.y1! - y0) * (node.missingIn.size / node.overlap.size);\n  return y1 - y0;\n}\n\nexport function pathGen(link: SankeyInternalLink, lineOffset: number, fraction: number, shift = 0): string {\n  const base = -link.width! / 2 + link.width! * shift;\n  const height = link.width! * fraction;\n\n  const targetOffset = missingInOffset(link.target as SankeyInternalNode);\n\n  const p = area<{ x: number; y0: number; y1: number }>()\n    .curve(curveMonotoneX)\n    .x((d) => d.x)\n    .y0((d) => d.y0)\n    .y1((d) => d.y1);\n\n  return (\n    p([\n      {\n        x: (link.source as SankeyInternalNode).x1!,\n        y0: link.y0! + base,\n        y1: link.y0! + base + height,\n      },\n      {\n        x: (link.source as SankeyInternalNode).x1! + lineOffset,\n        y0: link.y0! + base,\n        y1: link.y0! + base + height,\n      },\n      {\n        x: (link.target as SankeyInternalNode).x0! - lineOffset,\n        y0: link.y1! + targetOffset + base,\n        y1: link.y1! + targetOffset + base + height,\n      },\n      {\n        x: (link.target as SankeyInternalNode).x0!,\n        y0: link.y1! + targetOffset + base,\n        y1: link.y1! + targetOffset + base + height,\n      },\n    ]) ?? ''\n  );\n}\n\nexport function missingOutPath(node: SankeyInternalNode, off: number, fraction = 1, shift = 0): string {\n  const x = node.x1!;\n  const y1 = node.y1!;\n  let y0 = y1 - (y1 - node.y0!) * (node.missingOut.size / node.overlap.size);\n  const height = (y1 - y0) * fraction;\n  y0 += (y1 - y0) * shift;\n  const width = height;\n  const x1 = x + width;\n\n  const curve1 = `L${x + off},${y0} C${x + off + width / 2},${y0} ${x1},${y1 - off - height / 2} ${x1},${y1 + off}`;\n  const curve2 = `L${x + off},${y1 + off} C${x + off},${y1 + off * 0.5} ${x + off * 0.5},${y1} ${x},${y1}`;\n  return `M${x},${y0} ${curve1} ${curve2} Z`;\n}\n\nexport function missingInPath(node: SankeyInternalNode, off: number, fraction = 1, shift = 0): string {\n  const x = node.x0!;\n  let y0 = node.y0!;\n  const y1 = y0 + (node.y1! - y0) * (node.missingIn.size / node.overlap.size);\n  const height = (y1 - y0) * fraction;\n  y0 += (y1 - y0) * shift;\n  const width = height;\n  const x1 = x - width;\n\n  const curve1 = `L${x - off},${y1} C${x - off - width / 2},${y1} ${x1},${y0 + off + height / 2} ${x1},${y0 - off}`;\n  const curve2 = `L${x - off},${y0 - off} C${x - off},${y0 - off * 0.5} ${x + off * 0.5},${y0} ${x},${y0}`;\n  return `M${x},${y1} ${curve1} ${curve2} Z`;\n}\n\nexport function toValue(value: number, total?: number): string {\n  if (total == null) {\n    return value.toLocaleString();\n  }\n  const percentage = Math.round((value * 1000) / total) / 10;\n  return `${percentage.toLocaleString()}% (${value.toLocaleString()}/${total.toLocaleString()})`;\n}\n\nexport function toPercentageSuffix(value: number, total?: number): string {\n  if (total == null) {\n    return '';\n  }\n  const percentage = Math.round((value * 1000) / total) / 10;\n  return ` (${percentage.toLocaleString()}%)`;\n}\n","/* eslint-disable react/prop-types */\nimport React, { FC } from 'react';\nimport { classNames } from '../../utils';\nimport type { SankeyInternalLayer } from './model';\nimport type { SankeySelections } from './hooks';\nimport { toValue } from './renderUtils';\n\nconst SankeyLayer: FC<{\n  i: number;\n  layer: SankeyInternalLayer;\n  maxLayerY1: number;\n  nodeWidth: number;\n  nLayers: number;\n  selections: SankeySelections;\n  lineOffset: number;\n  total?: number;\n}> = ({ layer, i, lineOffset, maxLayerY1, nLayers, nodeWidth, selections, total }) => {\n  const layerHeight = maxLayerY1 - layer.y0;\n  let x = i > 0 ? nodeWidth / 2 : 0;\n  if (i === nLayers - 1) {\n    x = nodeWidth;\n  }\n  return (\n    <g\n      key={layer.id}\n      transform={`translate(${layer.x0 ?? 0},${layer.y0 ?? 0})`}\n      data-type=\"layer\"\n      data-id={layer.id}\n      onClick={selections.onClick}\n      onMouseEnter={selections.onMouseEnter}\n      onMouseLeave={selections.onMouseLeave}\n      className={classNames(selections.isSelected('layer', layer.id) && 'dash-sankey-layer__picked')}\n    >\n      <text\n        x={x}\n        y={layerHeight}\n        dy={lineOffset + 2}\n        className={classNames(\n          'dash-sankey-layer-name',\n          i === 0 && 'dash-sankey-layer-name__first',\n          i === nLayers - 1 && 'dash-sankey-layer-name__last'\n        )}\n      >\n        {layer.name}\n      </text>\n      <title>\n        {layer.name}: {toValue(layer.overlap.length, total)}\n      </title>\n    </g>\n  );\n};\n\nexport default SankeyLayer;\n","/* eslint-disable react/prop-types */\nimport React, { FC } from 'react';\nimport { classNames, OverlapHelper } from '../../utils';\nimport type { SankeySelections } from './hooks';\nimport type { SankeyID, SankeyInternalLink, SankeyInternalNode } from './model';\nimport { pathGen, toValue } from './renderUtils';\n\nconst SankeyLink: FC<{\n  link: SankeyInternalLink;\n  lineOffset: number;\n  selections: SankeySelections;\n  total?: number;\n}> = ({ link, lineOffset, selections, total: allIds }) => {\n  const overlap = selections.overlap.intersect(link.overlap);\n  const total = link.overlap.size;\n  let selectionShift = 0;\n  let prevOverlap: OverlapHelper<SankeyID> | null = null;\n  const shiftSelections = selections.others.length < 3;\n  return (\n    <g\n      key={link.id}\n      data-type=\"link\"\n      data-id={link.id}\n      onClick={selections.onClick}\n      onMouseEnter={selections.onMouseEnter}\n      onMouseLeave={selections.onMouseLeave}\n    >\n      <path\n        d={pathGen(link, lineOffset, 1)}\n        className={classNames('dash-sankey-link', selections.isSelected('link', link.id) && 'dash-sankey-link__picked')}\n      />\n      <title>\n        {link.name}: {toValue(link.value, allIds)}\n      </title>\n      {selections.others.map((s) => {\n        if (prevOverlap != null && !prevOverlap.isEmpty && shiftSelections) {\n          selectionShift += prevOverlap.without(s.overlap).size;\n        }\n        const o = s.overlap.intersect(link.overlap);\n        prevOverlap = o;\n        if (\n          o.isEmpty ||\n          (!s.matchLayer((link.source as SankeyInternalNode).layer ?? 0) &&\n            !s.matchLayer((link.target as SankeyInternalNode).layer ?? 0))\n        ) {\n          return null;\n        }\n        return (\n          <path\n            key={s.color}\n            d={pathGen(link, lineOffset, o.size / total, selectionShift / link.overlap.size)}\n            className=\"dash-sankey-link dash-sankey-selection\"\n            style={{ fill: s.color }}\n          />\n        );\n      })}\n      {overlap.isNotEmpty && (\n        <path\n          d={pathGen(link, lineOffset, overlap.size / link.overlap.size)}\n          className=\"dash-sankey-link dash-sankey-link__selected\"\n        />\n      )}\n    </g>\n  );\n};\n\nexport default SankeyLink;\n","/* eslint-disable react/prop-types */\nimport React, { FC } from 'react';\nimport { classNames, OverlapHelper } from '../../utils';\nimport type { SankeySelections } from './hooks';\nimport type { SankeyID, SankeyInternalNode } from './model';\nimport { missingInPath, toValue } from './renderUtils';\n\nconst SankeyMissingInLink: FC<{\n  node: SankeyInternalNode;\n  selections: SankeySelections;\n  lineOffset: number;\n  total?: number;\n}> = ({ node, selections, lineOffset, total: allIds }) => {\n  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n  if (node.missingIn.isEmpty || node.layer! <= 0) {\n    return null;\n  }\n  const overlap = selections.overlap.intersect(node.missingIn);\n  const total = node.missingIn.size;\n  let selectionShift = 0;\n  let prevOverlap: OverlapHelper<SankeyID> | null = null;\n  const shiftSelections = selections.others.length < 3;\n  return (\n    <g\n      key={node.id}\n      data-type=\"missing_in\"\n      data-id={node.id}\n      onClick={selections.onClick}\n      onMouseEnter={selections.onMouseEnter}\n      onMouseLeave={selections.onMouseLeave}\n    >\n      <path\n        d={missingInPath(node, lineOffset, 1)}\n        className={classNames(\n          'dash-sankey-link dash-sankey-link__missing',\n          selections.isSelected('missing_in', node.id) && 'dash-sankey-link__picked'\n        )}\n      />\n      <title>\n        ?  {node.name}: {toValue(node.missingIn.length, allIds)}\n      </title>\n      {selections.others.map((s) => {\n        if (prevOverlap != null && !prevOverlap.isEmpty && shiftSelections) {\n          selectionShift += prevOverlap.without(s.overlap).size;\n        }\n        const o = s.overlap.intersect(node.missingIn);\n        prevOverlap = o;\n        if (o.isEmpty || !s.matchLayer(node.layer ?? 0)) {\n          return null;\n        }\n        return (\n          <path\n            key={s.color}\n            d={missingInPath(node, lineOffset, o.size / total, selectionShift / total)}\n            className=\"dash-sankey-link dash-sankey-link__missing dash-sankey-selection\"\n            style={{ fill: s.color }}\n          />\n        );\n      })}\n      {overlap.isNotEmpty && (\n        <path\n          d={missingInPath(node, lineOffset, overlap.size / total, selectionShift / total)}\n          className=\"dash-sankey-link dash-sankey-link__missing dash-sankey-link__selected\"\n        />\n      )}\n    </g>\n  );\n};\n\nexport default SankeyMissingInLink;\n","/* eslint-disable react/prop-types */\nimport React, { FC } from 'react';\nimport { classNames, OverlapHelper } from '../../utils';\nimport type { SankeySelections } from './hooks';\nimport type { SankeyID, SankeyInternalNode } from './model';\nimport { missingOutPath, toValue } from './renderUtils';\n\nconst SankeyMissingOutLink: FC<{\n  node: SankeyInternalNode;\n  nLayers: number;\n  selections: SankeySelections;\n  lineOffset: number;\n  total?: number;\n}> = ({ node, nLayers, selections, lineOffset, total: allIds }) => {\n  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n  const isLastLayer = node.layer! >= nLayers - 1;\n  if (node.missingOut.isEmpty || isLastLayer) {\n    return null;\n  }\n  const overlap = selections.overlap.intersect(node.missingOut);\n  const total = node.missingOut.size;\n  let selectionShift = 0;\n  let prevOverlap: OverlapHelper<SankeyID> | null = null;\n  const shiftSelections = selections.others.length < 3;\n  return (\n    <g\n      key={node.id}\n      data-type=\"missing_out\"\n      data-id={node.id}\n      onClick={selections.onClick}\n      onMouseEnter={selections.onMouseEnter}\n      onMouseLeave={selections.onMouseLeave}\n    >\n      <path\n        d={missingOutPath(node, lineOffset, 1)}\n        className={classNames(\n          'dash-sankey-link dash-sankey-link__missing',\n          selections.isSelected('missing_out', node.id) && 'dash-sankey-link__picked'\n        )}\n      />\n      <title>\n        {node.name}  ?: {toValue(node.missingOut.length, allIds)}\n      </title>\n      {selections.others.map((s) => {\n        if (prevOverlap != null && !prevOverlap.isEmpty && shiftSelections) {\n          selectionShift += prevOverlap.without(s.overlap).size;\n        }\n        const o = s.overlap.intersect(node.missingOut);\n        prevOverlap = o;\n        if (o.isEmpty || !s.matchLayer(node.layer ?? 0)) {\n          return null;\n        }\n        return (\n          <path\n            key={s.color}\n            d={missingOutPath(node, lineOffset, o.size / total, selectionShift / total)}\n            className=\"dash-sankey-link dash-sankey-link__missing dash-sankey-selection\"\n            style={{ fill: s.color }}\n          />\n        );\n      })}\n      {overlap.isNotEmpty && (\n        <path\n          d={missingOutPath(node, lineOffset, overlap.size / total)}\n          className=\"dash-sankey-link dash-sankey-link__missing dash-sankey-link__selected\"\n        />\n      )}\n    </g>\n  );\n};\n\nexport default SankeyMissingOutLink;\n","/* eslint-disable @typescript-eslint/no-non-null-assertion */\n/* eslint-disable react/prop-types */\nimport React, { FC } from 'react';\nimport { classNames, OverlapHelper } from '../../utils';\nimport type { SankeyID, SankeyInternalNode } from './model';\nimport type { SankeySelections } from './hooks';\nimport { toPercentageSuffix, toValue } from './renderUtils';\n\nconst SankeyNode: FC<{\n  node: SankeyInternalNode;\n  selections: SankeySelections;\n  nodeWidth: number;\n  nLayers: number;\n  total?: number;\n}> = ({ node, selections, nodeWidth, nLayers, total: allIds }) => {\n  const overlap = selections.overlap.intersect(node.overlap);\n  const nodeHeight = node.y1! - node.y0!;\n  const isLastLayer = node.layer! >= nLayers - 1;\n  const total = node.overlap.size;\n  let selectionShift = 0;\n  let prevOverlap: OverlapHelper<SankeyID> | null = null;\n  const shiftSelections = selections.others.length < 3;\n  return (\n    <g\n      key={node.id}\n      data-type=\"node\"\n      data-id={node.id}\n      transform={`translate(${node.x0!},${node.y0!})`}\n      onClick={selections.onClick}\n      onMouseEnter={selections.onMouseEnter}\n      onMouseLeave={selections.onMouseLeave}\n    >\n      <rect\n        width={nodeWidth}\n        height={nodeHeight}\n        className={classNames('dash-sankey-node', selections.isSelected('node', node.id) && 'dash-sankey-node__picked')}\n      />\n      {selections.others.map((s) => {\n        if (prevOverlap != null && !prevOverlap.isEmpty && shiftSelections) {\n          selectionShift += prevOverlap.without(s.overlap).size;\n        }\n        const o = s.overlap.intersect(node.overlap);\n        prevOverlap = o;\n        if (o.isEmpty || !s.matchLayer(node.layer ?? 0)) {\n          return null;\n        }\n        return (\n          <rect\n            key={s.color}\n            y={nodeHeight * (selectionShift / total)}\n            width={nodeWidth}\n            height={nodeHeight * (o.size / total)}\n            className=\"dash-sankey-node dash-sankey-selection\"\n            style={{ fill: s.color }}\n          />\n        );\n      })}\n      {overlap.isNotEmpty && (\n        <rect\n          width={nodeWidth}\n          height={nodeHeight * (overlap.size / total)}\n          className=\"dash-sankey-node dash-sankey-node__selected\"\n        />\n      )}\n      <text\n        x={!isLastLayer ? nodeWidth : 0}\n        y={nodeHeight / 2}\n        dx={!isLastLayer ? 2 : -2}\n        className={classNames('dash-sankey-node-name', isLastLayer && 'dash-sankey-node-name__last')}\n      >\n        {node.name}\n        {toPercentageSuffix(node.value!, allIds)}\n      </text>\n      <title>\n        {node.name}: {toValue(node.value!, allIds)}\n      </title>\n    </g>\n  );\n};\n\nexport default SankeyNode;\n","/* eslint-disable react/destructuring-assignment */\n/* eslint-disable react/prop-types */\nimport React, { FC, Fragment } from 'react';\nimport { SankeyLayoutOptions, useSankeyLayout, useSelections } from './hooks';\nimport type { SankeyExtraSelection, SankeyID, SankeyLayer, SankeyLink, SankeyNode, SankeySelection } from './model';\nimport SankeyLayerC from './SankeyLayer';\nimport SankeyLinkC from './SankeyLink';\nimport SankeyMissingInLink from './SankeyMissingInLink';\nimport SankeyMissingOutLink from './SankeyMissingOutLink';\nimport SankeyNodeC from './SankeyNode';\n\nexport interface DashSankeyImplProps extends SankeyLayoutOptions {\n  /**\n   * offset around line before bending\n   * @default 5\n   */\n  lineOffset?: number;\n\n  /**\n   * render layers\n   * @default true\n   */\n  showLayers?: boolean;\n\n  total?: number;\n\n  width: number;\n  height: number;\n\n  layers?: readonly SankeyLayer[];\n  nodes?: readonly SankeyNode[];\n  links?: readonly SankeyLink[];\n\n  selections?: SankeyExtraSelection[];\n\n  selection?: SankeySelection | readonly SankeyID[];\n  setProps?(props: { selection?: SankeySelection | readonly SankeyID[] }): void;\n}\n\nconst DashSankeyImpl: FC<DashSankeyImplProps> = (props) => {\n  const { lineOffset = 5, layers, nodes, links, showLayers = true, total } = props;\n\n  const { layoutGraph, maxLayerY1, nodeWidth, graph } = useSankeyLayout(\n    { layers, nodes, links },\n    {\n      width: props.width,\n      height: props.height,\n      iterations: props.iterations,\n      nodeAlign: props.nodeAlign,\n      nodePadding: props.nodePadding,\n      nodeSort: props.nodeSort,\n      nodeWidth: props.nodeWidth,\n      padding: props.padding,\n    }\n  );\n  const selections = useSelections(graph, {\n    selection: props.selection,\n    selections: props.selections,\n    setProps: props.setProps,\n  });\n\n  return (\n    <>\n      <g className=\"dash-sankey-links\">\n        {layoutGraph.links.map((link) => (\n          <SankeyLinkC key={link.id} selections={selections} link={link} lineOffset={lineOffset} total={total} />\n        ))}\n        {layoutGraph.nodes.map((node) => (\n          <Fragment key={node.id}>\n            <SankeyMissingInLink selections={selections} node={node} lineOffset={lineOffset} total={total} />\n            <SankeyMissingOutLink\n              key={node.id}\n              selections={selections}\n              node={node}\n              nLayers={layoutGraph.layers.length}\n              lineOffset={lineOffset}\n              total={total}\n            />\n          </Fragment>\n        ))}\n      </g>\n      {showLayers && (\n        <g className=\"dash-sankey-layers\">\n          {layoutGraph.layers.map((layer, i) => (\n            <SankeyLayerC\n              key={layer.id}\n              selections={selections}\n              layer={layer}\n              maxLayerY1={maxLayerY1}\n              i={i}\n              nLayers={layoutGraph.layers.length}\n              nodeWidth={nodeWidth}\n              lineOffset={lineOffset}\n              total={total}\n            />\n          ))}\n        </g>\n      )}\n      <g className=\"dash-sankey-nodes\">\n        {layoutGraph.nodes.map((node) => (\n          <SankeyNodeC\n            key={node.id}\n            selections={selections}\n            node={node}\n            nLayers={layoutGraph.layers.length}\n            nodeWidth={nodeWidth}\n            total={total}\n          />\n        ))}\n      </g>\n    </>\n  );\n};\n\nexport default DashSankeyImpl;\n","import PropTypes from 'prop-types';\nimport type { SankeySelection } from 'src/lib/components/DashSankey';\n\nexport const ID_ARRAY = PropTypes.arrayOf(\n  PropTypes.oneOfType([PropTypes.string.isRequired, PropTypes.number.isRequired]).isRequired\n).isRequired;\n\nexport const NODE_ARR = PropTypes.arrayOf(\n  PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    name: PropTypes.string.isRequired,\n    ids: ID_ARRAY,\n    layer: PropTypes.number,\n  }).isRequired\n);\nexport const LINK_ARR = PropTypes.arrayOf(\n  PropTypes.shape({\n    source: PropTypes.string.isRequired,\n    target: PropTypes.string.isRequired,\n    ids: PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.string.isRequired, PropTypes.number.isRequired]).isRequired),\n  }).isRequired\n);\n\nexport const SELECTION_PROP_TYPE = PropTypes.oneOfType([\n  ID_ARRAY,\n  PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    type: PropTypes.oneOf<SankeySelection['type']>(['node', 'link', 'missing_in', 'missing_out', 'layer']).isRequired,\n    ids: ID_ARRAY,\n  }),\n]);\n","/* eslint-disable react/jsx-props-no-spreading */\n/* eslint-disable react/destructuring-assignment */\n/* eslint-disable @typescript-eslint/no-non-null-assertion */\nimport PropTypes from 'prop-types';\nimport React, { FC, useCallback, useMemo } from 'react';\nimport useResizeObserver from 'use-resize-observer';\nimport DashSankeyImpl from '../internal/sankey/DashSankeyImpl';\nimport type { SankeyLayoutOptions } from '../internal/sankey/hooks';\nimport {\n  DEFAULT_PADDING,\n  SankeyExtraSelection,\n  SankeyID,\n  SankeyLayer,\n  SankeyLink,\n  SankeyNode,\n  SankeySelection,\n} from '../internal/sankey/model';\nimport { ID_ARRAY, LINK_ARR, NODE_ARR, SELECTION_PROP_TYPE } from '../internal/sankey/propTypes';\nimport { deriveBox, PADDING_PROP_TYPES } from '../utils';\nimport './DashSankey.css';\n\nexport type {\n  SankeyExtraSelection,\n  SankeyID,\n  SankeyLayer,\n  SankeyLink,\n  SankeyNode,\n  SankeySelection,\n} from '../internal/sankey/model';\n\nexport interface DashChangeAbleSankeyProps {\n  selection?: SankeySelection | readonly SankeyID[];\n}\n\nexport interface DashReadOnlyLayoutSankeyProps extends SankeyLayoutOptions {\n  /**\n   * offset around line before bending\n   * @default 5\n   */\n  lineOffset?: number;\n\n  /**\n   * render layers\n   * @default true\n   */\n  showLayers?: boolean;\n\n  /**\n   * total number of ids to show percentages\n   */\n  total?: number;\n}\n\nexport type DashSankeyProps = DashReadOnlyLayoutSankeyProps & {\n  layers?: readonly SankeyLayer[];\n  nodes?: readonly SankeyNode[];\n  links?: readonly SankeyLink[];\n} & DashChangeAbleSankeyProps & {\n    selections?: SankeyExtraSelection[];\n    id?: string;\n    setProps?(props: DashChangeAbleSankeyProps): void;\n    children?: React.ReactNode;\n  };\n\n/**\n * DashSankey shows an interactive parallel set / sankey diagram\n */\nconst DashSankey: FC<DashSankeyProps> = (props) => {\n  const { id, children, height = 300, setProps } = props;\n\n  const resetSelection = useCallback(() => {\n    if (setProps) {\n      setProps({ selection: [] });\n    }\n  }, [setProps]);\n\n  const p = useMemo(() => deriveBox(props.padding ?? DEFAULT_PADDING, DEFAULT_PADDING), [props.padding]);\n  const { ref, width: computedWidth = p.left + p.right + 10 } = useResizeObserver<HTMLDivElement>();\n  const fixedWidth = props.width ?? computedWidth;\n\n  return (\n    <div ref={ref} id={id}>\n      <svg width={fixedWidth} height={height} className=\"dash-sankey\" onClick={resetSelection}>\n        <DashSankeyImpl {...props} width={fixedWidth} height={height} />\n        {children}\n      </svg>\n    </div>\n  );\n};\n\nDashSankey.defaultProps = {\n  id: undefined,\n  setProps: undefined,\n  width: undefined,\n  height: 300,\n  padding: DEFAULT_PADDING,\n  lineOffset: 5,\n  iterations: 6,\n  nodeWidth: 24,\n  nodePadding: 8,\n  nodeAlign: 'justify',\n  nodeSort: 'auto',\n  children: [],\n  selection: undefined,\n  selections: undefined,\n  layers: undefined,\n  nodes: undefined,\n  links: undefined,\n  showLayers: true,\n  total: undefined,\n};\n\nDashSankey.propTypes = {\n  /**\n   * The ID used to identify this component in Dash callbacks.\n   */\n  id: PropTypes.string,\n  /**\n   * set props helper for dash\n   */\n  setProps: PropTypes.func,\n  /**\n   * children helper for dash\n   */\n  children: PropTypes.node,\n\n  // layout\n  /**\n   * width of the resulting chart\n   */\n  width: PropTypes.number,\n  /**\n   * height of the resulting chart\n   * @default 300\n   */\n  height: PropTypes.number,\n  /**\n   * padding around SVG\n   * @default 5\n   */\n  padding: PADDING_PROP_TYPES,\n\n  /**\n   * offset between lines\n   * @default 5\n   */\n  lineOffset: PropTypes.number,\n  /**\n   * show layer names\n   * @default true\n   */\n  showLayers: PropTypes.bool,\n\n  /**\n   * total number of ids to show percentages\n   */\n  total: PropTypes.number,\n  /**\n   * sets the number of relaxation iterations when generating the layout and returns this Sankey generator.\n   * @default 6\n   */\n  iterations: PropTypes.number,\n  /**\n   * sets the node width to the specified number and returns this Sankey generator.\n   * @default 24\n   */\n  nodeWidth: PropTypes.number,\n  /**\n   *  sets the vertical separation between nodes at each column to the specified number and returns this Sankey generator.\n   * @default 8\n   */\n  nodePadding: PropTypes.number,\n  /**\n   * justify method\n   * @default 'justify';\n   */\n  nodeAlign: PropTypes.oneOf<DashReadOnlyLayoutSankeyProps['nodeAlign']>([\n    'left',\n    'right',\n    'center',\n    'justify',\n    'layer',\n  ]),\n  /**\n   * node sort order\n   * @default 'auto'\n   */\n  nodeSort: PropTypes.oneOf<DashReadOnlyLayoutSankeyProps['nodeSort']>(['auto', 'fixed']),\n\n  /**\n   * level sankey data\n   */\n  layers: PropTypes.arrayOf(\n    PropTypes.shape({\n      name: PropTypes.string.isRequired,\n      nodes: PropTypes.arrayOf(\n        PropTypes.shape({\n          id: PropTypes.string.isRequired,\n          name: PropTypes.string.isRequired,\n          ids: ID_ARRAY,\n        }).isRequired\n      ).isRequired,\n    }).isRequired\n  ),\n  /**\n   * nodes data as an alternative to layers\n   */\n  nodes: NODE_ARR as React.Validator<readonly SankeyNode[]> | undefined,\n  /**\n   * link data as an alternative to layers\n   */\n  links: LINK_ARR as React.Validator<readonly SankeyLink[]> | undefined,\n\n  /**\n   * the selection to highlight\n   */\n  selection: SELECTION_PROP_TYPE,\n  /**\n   * additional selections to highlight in their given color\n   */\n  selections: PropTypes.arrayOf(\n    PropTypes.shape({\n      color: PropTypes.string.isRequired,\n      ids: ID_ARRAY,\n    }).isRequired\n  ),\n};\n\nexport default DashSankey;\n","/* eslint-disable react/require-default-props */\n/* eslint-disable react/jsx-props-no-spreading */\n/* eslint-disable react/destructuring-assignment */\n/* eslint-disable @typescript-eslint/no-non-null-assertion */\nimport PropTypes from 'prop-types';\nimport React, { FC, useCallback, useMemo } from 'react';\nimport useResizeObserver from 'use-resize-observer';\nimport { deriveBox, PADDING_PROP_TYPES } from '../utils';\nimport './DashSankey.css';\nimport type { DashChangeAbleSankeyProps, DashReadOnlyLayoutSankeyProps } from './DashSankey';\nimport DashSankey from './DashSankey';\nimport { ID_ARRAY, LINK_ARR, NODE_ARR } from '../internal/sankey/propTypes';\nimport {\n  DEFAULT_PADDING,\n  FacettedSankeySelection,\n  SankeyExtraSelection,\n  SankeyID,\n  SankeyLayer,\n  SankeyLink,\n  SankeyNode,\n  SankeySelection,\n} from '../internal/sankey/model';\nimport DashSankeyImpl from '../internal/sankey/DashSankeyImpl';\n\nexport type { FacettedSankeySelection } from '../internal/sankey/model';\n\nexport interface FacettedSankeyChangeAbleProps {\n  selection?: FacettedSankeySelection | readonly SankeyID[];\n}\n\nexport type FacettedSankeyProps = DashReadOnlyLayoutSankeyProps & {\n  facets: readonly {\n    name: string;\n    layers?: readonly SankeyLayer[];\n    nodes?: readonly SankeyNode[];\n    links?: readonly SankeyLink[];\n    total?: number;\n  }[];\n} & FacettedSankeyChangeAbleProps & {\n    selections?: SankeyExtraSelection[];\n    id?: string;\n    setProps?(props: FacettedSankeyChangeAbleProps): void;\n    children?: React.ReactNode;\n  };\n\n/**\n * FacettedSankey shows an interactive parallel set / sankey diagram\n */\nconst FacettedSankey: FC<FacettedSankeyProps> = (props) => {\n  const { id, children, height = 300, setProps, facets, selection } = props;\n\n  const resetSelection = useCallback(() => {\n    if (setProps) {\n      setProps({ selection: [] });\n    }\n  }, [setProps]);\n\n  const p = useMemo(() => deriveBox(props.padding ?? DEFAULT_PADDING, DEFAULT_PADDING), [props.padding]);\n\n  const { ref, width: computedWidth = p.left + p.right + 10 } = useResizeObserver<HTMLDivElement>();\n  const width = props.width ?? computedWidth;\n  const facetHeight = facets.length > 0 ? height / facets.length : height;\n\n  const facetObjects = useMemo(\n    () =>\n      facets.map((f) => ({\n        ...f,\n        setProps: (changed: DashChangeAbleSankeyProps) => {\n          if (!setProps) {\n            return;\n          }\n          if (changed.selection == null || Array.isArray(changed.selection)) {\n            setProps(changed as { selection: readonly SankeyID[] | undefined });\n            return;\n          }\n          const s = {\n            ...changed.selection,\n            facet: f.name,\n          };\n          setProps({ selection: s });\n        },\n        selection:\n          Array.isArray(selection) || selection == null || (selection as FacettedSankeySelection).facet === f.name\n            ? selection\n            : undefined,\n      })),\n    [facets, setProps, selection]\n  );\n\n  return (\n    <div ref={ref} id={id}>\n      <svg width={width} height={height} className=\"dash-sankey\" onClick={resetSelection}>\n        {facetObjects.map((facet, i) => (\n          <g key={facet.name} transform={`translate(0, ${i * facetHeight})`}>\n            <text x={width - 12} y={facetHeight / 2} className=\"dash-sankey-facet-name\">\n              {facet.name}\n            </text>\n            <DashSankeyImpl {...props} {...facet} width={width - 16} height={facetHeight} />\n          </g>\n        ))}\n        {children}\n      </svg>\n    </div>\n  );\n};\n\nconst SELECTION_PROP_TYPE = PropTypes.oneOfType([\n  ID_ARRAY,\n  PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    type: PropTypes.oneOf<SankeySelection['type']>(['node', 'link', 'missing_in', 'missing_out', 'layer']).isRequired,\n    ids: ID_ARRAY,\n    facet: PropTypes.string.isRequired,\n  }),\n]);\n\nFacettedSankey.propTypes = {\n  /**\n   * The ID used to identify this component in Dash callbacks.\n   */\n  id: PropTypes.string,\n  /**\n   * set props helper for dash\n   */\n  setProps: PropTypes.func,\n  /**\n   * children helper for dash\n   */\n  children: PropTypes.node,\n\n  // layout\n  /**\n   * width of the resulting chart\n   */\n  width: PropTypes.number,\n  /**\n   * height of the resulting chart\n   * @default 300\n   */\n  height: PropTypes.number,\n  /**\n   * padding around SVG\n   * @default 5\n   */\n  padding: PADDING_PROP_TYPES,\n\n  /**\n   * offset between lines\n   * @default 5\n   */\n  lineOffset: PropTypes.number,\n  /**\n   * show layer names\n   * @default true\n   */\n  showLayers: PropTypes.bool,\n  /**\n   * sets the number of relaxation iterations when generating the layout and returns this Sankey generator.\n   * @default 6\n   */\n  iterations: PropTypes.number,\n  /**\n   * sets the node width to the specified number and returns this Sankey generator.\n   * @default 24\n   */\n  nodeWidth: PropTypes.number,\n  /**\n   *  sets the vertical separation between nodes at each column to the specified number and returns this Sankey generator.\n   * @default 8\n   */\n  nodePadding: PropTypes.number,\n  /**\n   * justify method\n   * @default 'justify';\n   */\n  nodeAlign: DashSankey.propTypes!.nodeAlign,\n  /**\n   * node sort order\n   * @default 'auto'\n   */\n  nodeSort: DashSankey.propTypes!.nodeSort,\n\n  /**\n   * the selection to highlight\n   */\n  selection: SELECTION_PROP_TYPE,\n  /**\n   * additional selections to highlight in their given color\n   */\n  selections: DashSankey.propTypes!.selections,\n  /**\n   * the facets sankey to render\n   */\n  facets: PropTypes.arrayOf(\n    PropTypes.shape({\n      name: PropTypes.string.isRequired,\n      /**\n       * level sankey data\n       */\n      layers: PropTypes.arrayOf(\n        PropTypes.shape({\n          name: PropTypes.string.isRequired,\n          nodes: PropTypes.arrayOf(\n            PropTypes.shape({\n              id: PropTypes.string.isRequired,\n              name: PropTypes.string.isRequired,\n              ids: ID_ARRAY,\n            }).isRequired\n          ).isRequired,\n        }).isRequired\n      ).isRequired,\n      /**\n       * nodes data as an alternative to layers\n       */\n      nodes: NODE_ARR as React.Validator<readonly SankeyNode[]> | undefined,\n      /**\n       * link data as an alternative to layers\n       */\n      links: LINK_ARR as React.Validator<readonly SankeyLink[]> | undefined,\n    }).isRequired\n  ).isRequired,\n};\n\nexport default FacettedSankey;\n","/* eslint-disable import/prefer-default-export */\nimport DashSankey from './components/DashSankey';\nimport FacettedSankey from './components/FacettedSankey';\n\nexport type {\n  DashChangeAbleSankeyProps,\n  DashReadOnlyLayoutSankeyProps,\n  DashSankeyProps,\n  SankeyLayer,\n  SankeyLink,\n  SankeyID,\n  SankeySelection,\n  SankeyNode,\n} from './components/DashSankey';\n\nexport type {\n  FacettedSankeyChangeAbleProps,\n  FacettedSankeyProps,\n  FacettedSankeySelection,\n} from './components/FacettedSankey';\n\nexport { DashSankey, FacettedSankey };\n"],"sourceRoot":""}